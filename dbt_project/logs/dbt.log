[0m13:44:27.987497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116a66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c9490>]}


============================== 13:44:27.989151 | 4d7dbc54-4ba0-49ae-b066-db64f15e4700 ==============================
[0m13:44:27.989151 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:44:27.989391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:27.989622 [info ] [MainThread]: dbt version: 1.7.18
[0m13:44:27.989747 [info ] [MainThread]: python version: 3.12.2
[0m13:44:27.989858 [info ] [MainThread]: python path: /Users/dipinjassal/ml/tmdb_data_warehouse/venv/bin/python3
[0m13:44:27.989973 [info ] [MainThread]: os info: macOS-15.6.1-arm64-arm-64bit
[0m13:44:27.992137 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_ACCOUNT'
[0m13:44:27.993071 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.027078375, "process_user_time": 0.684793, "process_kernel_time": 0.070647, "process_mem_max_rss": "118767616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:44:27.993292 [debug] [MainThread]: Command `dbt debug` failed at 13:44:27.993244 after 0.03 seconds
[0m13:44:27.993411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116cb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114cd2e0>]}
[0m13:44:27.993538 [debug] [MainThread]: Flushing usage events
[0m13:47:29.752989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106887350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067402f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068cd820>]}


============================== 13:47:29.754672 | 4a87890e-0136-4ec8-97b1-5ad3540cf54e ==============================
[0m13:47:29.754672 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:47:29.754907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:29.755129 [info ] [MainThread]: dbt version: 1.7.18
[0m13:47:29.755257 [info ] [MainThread]: python version: 3.12.2
[0m13:47:29.755386 [info ] [MainThread]: python path: /Users/dipinjassal/ml/tmdb_data_warehouse/venv/bin/python3
[0m13:47:29.755509 [info ] [MainThread]: os info: macOS-15.6.1-arm64-arm-64bit
[0m13:47:29.757380 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'PSMDSVM-MUC25951'
[0m13:47:29.758319 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.024771124, "process_user_time": 0.658906, "process_kernel_time": 0.069044, "process_mem_max_rss": "113442816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:47:29.758528 [debug] [MainThread]: Command `dbt debug` failed at 13:47:29.758479 after 0.03 seconds
[0m13:47:29.758655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106781970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f82cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068cda30>]}
[0m13:47:29.758788 [debug] [MainThread]: Flushing usage events
[0m13:48:36.683089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111581610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c9640>]}


============================== 13:48:36.684651 | 0706ce91-5ee4-40e4-b98c-a7c21ba65a47 ==============================
[0m13:48:36.684651 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:48:36.684879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m13:48:36.685088 [info ] [MainThread]: dbt version: 1.7.18
[0m13:48:36.685215 [info ] [MainThread]: python version: 3.12.2
[0m13:48:36.685330 [info ] [MainThread]: python path: /Users/dipinjassal/ml/tmdb_data_warehouse/venv/bin/python3
[0m13:48:36.685443 [info ] [MainThread]: os info: macOS-15.6.1-arm64-arm-64bit
[0m13:48:37.074142 [info ] [MainThread]: Using profiles dir at .
[0m13:48:37.074357 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m13:48:37.074502 [info ] [MainThread]: Using dbt_project.yml file at /Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/dbt_project.yml
[0m13:48:37.074689 [info ] [MainThread]: adapter type: snowflake
[0m13:48:37.074822 [info ] [MainThread]: adapter version: 1.7.5
[0m13:48:37.098188 [info ] [MainThread]: Configuration:
[0m13:48:37.098355 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:48:37.098484 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:48:37.098602 [info ] [MainThread]: Required dependencies:
[0m13:48:37.098740 [debug] [MainThread]: Executing "git --help"
[0m13:48:37.109344 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:48:37.109703 [debug] [MainThread]: STDERR: "b''"
[0m13:48:37.109864 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:48:37.109998 [info ] [MainThread]: Connection:
[0m13:48:37.110135 [info ] [MainThread]:   account: PSMDSVM-MUC25951
[0m13:48:37.110261 [info ] [MainThread]:   user: charveesaraiya
[0m13:48:37.110372 [info ] [MainThread]:   database: TMDB_DW
[0m13:48:37.110479 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m13:48:37.110589 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m13:48:37.110699 [info ] [MainThread]:   schema: ANALYTICS
[0m13:48:37.110809 [info ] [MainThread]:   authenticator: None
[0m13:48:37.110917 [info ] [MainThread]:   oauth_client_id: None
[0m13:48:37.111023 [info ] [MainThread]:   query_tag: None
[0m13:48:37.111130 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:48:37.111241 [info ] [MainThread]:   host: None
[0m13:48:37.111349 [info ] [MainThread]:   port: None
[0m13:48:37.111456 [info ] [MainThread]:   proxy_host: None
[0m13:48:37.111561 [info ] [MainThread]:   proxy_port: None
[0m13:48:37.111668 [info ] [MainThread]:   protocol: None
[0m13:48:37.111772 [info ] [MainThread]:   connect_retries: 1
[0m13:48:37.111876 [info ] [MainThread]:   connect_timeout: None
[0m13:48:37.111982 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:48:37.112088 [info ] [MainThread]:   retry_all: False
[0m13:48:37.112191 [info ] [MainThread]:   insecure_mode: False
[0m13:48:37.112297 [info ] [MainThread]:   reuse_connections: None
[0m13:48:37.112473 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m13:48:37.117591 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:48:37.118209 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:48:37.118337 [debug] [MainThread]: On debug: select 1 as id
[0m13:48:37.118443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:39.638857 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.0 seconds
[0m13:48:39.641147 [debug] [MainThread]: On debug: Close
[0m13:48:39.867902 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:48:39.868950 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:48:39.874978 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.2109447, "process_user_time": 1.065496, "process_kernel_time": 0.177413, "process_mem_max_rss": "199786496", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:48:39.875837 [debug] [MainThread]: Command `dbt debug` succeeded at 13:48:39.875678 after 3.21 seconds
[0m13:48:39.876211 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:48:39.876542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111442ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11239da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12047f5c0>]}
[0m13:48:39.876922 [debug] [MainThread]: Flushing usage events
[0m13:48:57.435343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cc2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595d790>]}


============================== 13:48:57.436973 | 0aa83c64-94ad-49aa-a149-21bc8a6ef53f ==============================
[0m13:48:57.436973 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:48:57.437216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m13:48:57.717359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10980cfe0>]}
[0m13:48:57.735625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936a9c0>]}
[0m13:48:57.735894 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m13:48:57.743158 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:48:57.743573 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:48:57.743732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099fef30>]}
[0m13:48:58.198862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b01a90>]}
[0m13:48:58.203873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109def230>]}
[0m13:48:58.204051 [info ] [MainThread]: Found 9 models, 32 tests, 4 sources, 0 exposures, 0 metrics, 460 macros, 0 groups, 0 semantic models
[0m13:48:58.204202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c97ad0>]}
[0m13:48:58.205095 [info ] [MainThread]: 
[0m13:48:58.205410 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:48:58.205926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW'
[0m13:48:58.206240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW'
[0m13:48:58.210928 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW"
[0m13:48:58.211750 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW"
[0m13:48:58.211887 [debug] [ThreadPool]: On list_TMDB_DW: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW"} */
show terse schemas in database TMDB_DW
    limit 10000
[0m13:48:58.212030 [debug] [ThreadPool]: On list_TMDB_DW: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW"} */
show terse schemas in database TMDB_DW
    limit 10000
[0m13:48:58.212153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:58.212254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:01.680958 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m13:49:01.683792 [debug] [ThreadPool]: On list_TMDB_DW: Close
[0m13:49:01.733451 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 4.0 seconds
[0m13:49:01.736651 [debug] [ThreadPool]: On list_TMDB_DW: Close
[0m13:49:01.943078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TMDB_DW, now create_TMDB_DW_ANALYTICS_staging)
[0m13:49:01.944105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TMDB_DW, now create_TMDB_DW_ANALYTICS_analytics)
[0m13:49:01.945284 [debug] [ThreadPool]: Creating schema "database: "TMDB_DW"
schema: "ANALYTICS_staging"
"
[0m13:49:01.946192 [debug] [ThreadPool]: Creating schema "database: "TMDB_DW"
schema: "ANALYTICS_analytics"
"
[0m13:49:01.952460 [debug] [ThreadPool]: Using snowflake connection "create_TMDB_DW_ANALYTICS_staging"
[0m13:49:01.954411 [debug] [ThreadPool]: Using snowflake connection "create_TMDB_DW_ANALYTICS_analytics"
[0m13:49:01.954753 [debug] [ThreadPool]: On create_TMDB_DW_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "create_TMDB_DW_ANALYTICS_staging"} */
create schema if not exists TMDB_DW.ANALYTICS_staging
[0m13:49:01.955143 [debug] [ThreadPool]: On create_TMDB_DW_ANALYTICS_analytics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "create_TMDB_DW_ANALYTICS_analytics"} */
create schema if not exists TMDB_DW.ANALYTICS_analytics
[0m13:49:01.955544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:01.955863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:05.321102 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 3.0 seconds
[0m13:49:05.323579 [debug] [ThreadPool]: On create_TMDB_DW_ANALYTICS_staging: Close
[0m13:49:05.360336 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 3.0 seconds
[0m13:49:05.361852 [debug] [ThreadPool]: On create_TMDB_DW_ANALYTICS_analytics: Close
[0m13:49:05.595018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_TMDB_DW_ANALYTICS_analytics, now list_TMDB_DW_ANALYTICS_staging)
[0m13:49:05.596352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_TMDB_DW_ANALYTICS_staging, now list_TMDB_DW_ANALYTICS_analytics)
[0m13:49:05.604604 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_staging"
[0m13:49:05.606322 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_analytics"
[0m13:49:05.606615 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_staging"} */
show objects in TMDB_DW.ANALYTICS_staging limit 10000
[0m13:49:05.606876 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_analytics"} */
show objects in TMDB_DW.ANALYTICS_analytics limit 10000
[0m13:49:05.607143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:05.607361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:06.207875 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:49:06.211018 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: Close
[0m13:49:06.814354 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:49:06.818421 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: Close
[0m13:49:07.036889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b44b00>]}
[0m13:49:07.038500 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:49:07.039115 [info ] [MainThread]: 
[0m13:49:07.043248 [debug] [Thread-1 (]: Began running node model.tmdb_analytics.dim_company
[0m13:49:07.043615 [debug] [Thread-2 (]: Began running node model.tmdb_analytics.dim_time
[0m13:49:07.043964 [debug] [Thread-3 (]: Began running node model.tmdb_analytics.stg_credits
[0m13:49:07.044350 [info ] [Thread-1 (]: 1 of 9 START sql table model ANALYTICS_analytics.dim_company ................... [RUN]
[0m13:49:07.044750 [debug] [Thread-4 (]: Began running node model.tmdb_analytics.stg_genres
[0m13:49:07.045153 [info ] [Thread-2 (]: 2 of 9 START sql table model ANALYTICS_analytics.dim_time ...................... [RUN]
[0m13:49:07.045564 [info ] [Thread-3 (]: 3 of 9 START sql view model ANALYTICS_staging.stg_credits ...................... [RUN]
[0m13:49:07.046128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_staging, now model.tmdb_analytics.dim_company)
[0m13:49:07.046425 [info ] [Thread-4 (]: 4 of 9 START sql view model ANALYTICS_staging.stg_genres ....................... [RUN]
[0m13:49:07.046888 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_analytics, now model.tmdb_analytics.dim_time)
[0m13:49:07.047344 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.tmdb_analytics.stg_credits'
[0m13:49:07.047583 [debug] [Thread-1 (]: Began compiling node model.tmdb_analytics.dim_company
[0m13:49:07.048522 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.tmdb_analytics.stg_genres'
[0m13:49:07.048767 [debug] [Thread-2 (]: Began compiling node model.tmdb_analytics.dim_time
[0m13:49:07.048999 [debug] [Thread-3 (]: Began compiling node model.tmdb_analytics.stg_credits
[0m13:49:07.054014 [debug] [Thread-1 (]: Writing injected SQL for node "model.tmdb_analytics.dim_company"
[0m13:49:07.054259 [debug] [Thread-4 (]: Began compiling node model.tmdb_analytics.stg_genres
[0m13:49:07.055992 [debug] [Thread-2 (]: Writing injected SQL for node "model.tmdb_analytics.dim_time"
[0m13:49:07.057513 [debug] [Thread-3 (]: Writing injected SQL for node "model.tmdb_analytics.stg_credits"
[0m13:49:07.059324 [debug] [Thread-4 (]: Writing injected SQL for node "model.tmdb_analytics.stg_genres"
[0m13:49:07.059963 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.stg_credits (compile): 13:49:07.056145 => 13:49:07.059828
[0m13:49:07.060222 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_time (compile): 13:49:07.054402 => 13:49:07.060091
[0m13:49:07.060519 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_genres (compile): 13:49:07.057755 => 13:49:07.060352
[0m13:49:07.060778 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_company (compile): 13:49:07.049165 => 13:49:07.060655
[0m13:49:07.060974 [debug] [Thread-3 (]: Began executing node model.tmdb_analytics.stg_credits
[0m13:49:07.061178 [debug] [Thread-2 (]: Began executing node model.tmdb_analytics.dim_time
[0m13:49:07.061361 [debug] [Thread-4 (]: Began executing node model.tmdb_analytics.stg_genres
[0m13:49:07.061543 [debug] [Thread-1 (]: Began executing node model.tmdb_analytics.dim_company
[0m13:49:07.082822 [debug] [Thread-3 (]: Writing runtime sql for node "model.tmdb_analytics.stg_credits"
[0m13:49:07.087289 [debug] [Thread-2 (]: Writing runtime sql for node "model.tmdb_analytics.dim_time"
[0m13:49:07.088716 [debug] [Thread-4 (]: Writing runtime sql for node "model.tmdb_analytics.stg_genres"
[0m13:49:07.089860 [debug] [Thread-1 (]: Writing runtime sql for node "model.tmdb_analytics.dim_company"
[0m13:49:07.090632 [debug] [Thread-4 (]: Using snowflake connection "model.tmdb_analytics.stg_genres"
[0m13:49:07.091072 [debug] [Thread-1 (]: Using snowflake connection "model.tmdb_analytics.dim_company"
[0m13:49:07.091656 [debug] [Thread-3 (]: Using snowflake connection "model.tmdb_analytics.stg_credits"
[0m13:49:07.091831 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_genres: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.stg_genres"} */
create or replace   view TMDB_DW.ANALYTICS_staging.stg_genres
  
   as (
    -- Staging model for genres

WITH source AS (
    SELECT * FROM TMDB_DW.RAW.raw_genres
)

SELECT
    id AS genre_id,
    TRIM(name) AS genre_name,
    loaded_at
FROM source
WHERE id IS NOT NULL
  );
[0m13:49:07.092465 [debug] [Thread-2 (]: Using snowflake connection "model.tmdb_analytics.dim_time"
[0m13:49:07.092635 [debug] [Thread-1 (]: On model.tmdb_analytics.dim_company: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_company"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_company
         as
        (-- Dimension table for production companies
-- SCD Type 1



WITH companies AS (
    SELECT * FROM TMDB_DW.RAW.raw_companies
),

final AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY id) AS company_key,
        id AS company_id,
        name AS company_name,
        origin_country,
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
    FROM companies
    WHERE id IS NOT NULL
)

SELECT * FROM final
        );
[0m13:49:07.092823 [debug] [Thread-3 (]: On model.tmdb_analytics.stg_credits: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.stg_credits"} */
create or replace   view TMDB_DW.ANALYTICS_staging.stg_credits
  
   as (
    -- Staging model for credits
-- Separates cast and crew

WITH source AS (
    SELECT * FROM TMDB_DW.RAW.raw_credits
),

cleaned AS (
    SELECT
        credit_id,
        movie_id,
        person_id,
        TRIM(name) AS person_name,
        TRIM(character) AS character_name,
        TRIM(job) AS job_title,
        TRIM(department) AS department,
        credit_type,
        gender,
        cast_order,
        
        -- Flag key roles
        CASE WHEN job_title = 'Director' THEN TRUE ELSE FALSE END AS is_director,
        CASE WHEN credit_type = 'cast' AND cast_order <= 5 THEN TRUE ELSE FALSE END AS is_lead_actor,
        
        loaded_at
        
    FROM source
    WHERE credit_id IS NOT NULL
      AND movie_id IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m13:49:07.093003 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:49:07.093180 [debug] [Thread-2 (]: On model.tmdb_analytics.dim_time: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_time"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_time
         as
        (-- Dimension table for time
-- Pre-populated date dimension



WITH date_spine AS (
    -- Generate dates from 1900 to 2030
    SELECT
        DATEADD(DAY, SEQ4(), '1900-01-01'::DATE) AS date_day
    FROM TABLE(GENERATOR(ROWCOUNT => 47482))
),

final AS (
    SELECT
        TO_NUMBER(TO_CHAR(date_day, 'YYYYMMDD')) AS date_key,
        date_day AS full_date,
        YEAR(date_day) AS year,
        QUARTER(date_day) AS quarter,
        MONTH(date_day) AS month,
        MONTHNAME(date_day) AS month_name,
        DAY(date_day) AS day,
        DAYOFWEEK(date_day) AS day_of_week,
        DAYNAME(date_day) AS day_name,
        WEEKOFYEAR(date_day) AS week_of_year,
        FLOOR(YEAR(date_day) / 10) * 10 AS decade,
        
        CASE 
            WHEN DAYOFWEEK(date_day) IN (0, 6) THEN TRUE 
            ELSE FALSE 
        END AS is_weekend,
        
        CASE 
            WHEN MONTH(date_day) IN (6, 7, 8) THEN 'Summer'
            WHEN MONTH(date_day) IN (9, 10, 11) THEN 'Fall'
            WHEN MONTH(date_day) IN (12, 1, 2) THEN 'Winter'
            ELSE 'Spring'
        END AS season
        
    FROM date_spine
)

SELECT * FROM final
        );
[0m13:49:07.093354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:07.093495 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:49:07.093835 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:07.789565 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:49:07.807819 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_genres (execute): 13:49:07.087440 => 13:49:07.807659
[0m13:49:07.808147 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_genres: Close
[0m13:49:08.011235 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a712b40>]}
[0m13:49:08.012964 [info ] [Thread-4 (]: 4 of 9 OK created sql view model ANALYTICS_staging.stg_genres .................. [[32mSUCCESS 1[0m in 0.96s]
[0m13:49:08.014058 [debug] [Thread-4 (]: Finished running node model.tmdb_analytics.stg_genres
[0m13:49:08.014583 [debug] [Thread-4 (]: Began running node model.tmdb_analytics.stg_movies
[0m13:49:08.015542 [info ] [Thread-4 (]: 5 of 9 START sql view model ANALYTICS_staging.stg_movies ....................... [RUN]
[0m13:49:08.016176 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.stg_genres, now model.tmdb_analytics.stg_movies)
[0m13:49:08.016393 [debug] [Thread-4 (]: Began compiling node model.tmdb_analytics.stg_movies
[0m13:49:08.018279 [debug] [Thread-4 (]: Writing injected SQL for node "model.tmdb_analytics.stg_movies"
[0m13:49:08.018874 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_movies (compile): 13:49:08.016519 => 13:49:08.018760
[0m13:49:08.019063 [debug] [Thread-4 (]: Began executing node model.tmdb_analytics.stg_movies
[0m13:49:08.020849 [debug] [Thread-4 (]: Writing runtime sql for node "model.tmdb_analytics.stg_movies"
[0m13:49:08.021767 [debug] [Thread-4 (]: Using snowflake connection "model.tmdb_analytics.stg_movies"
[0m13:49:08.021970 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_movies: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.stg_movies"} */
create or replace   view TMDB_DW.ANALYTICS_staging.stg_movies
  
   as (
    -- Staging model for movies
-- Cleans and standardizes raw movie data

WITH source AS (
    SELECT * FROM TMDB_DW.RAW.raw_movies
),

cleaned AS (
    SELECT
        id AS movie_id,
        TRIM(title) AS title,
        TRIM(original_title) AS original_title,
        overview,
        TRY_CAST(release_date AS DATE) AS release_date,
        popularity,
        vote_average,
        vote_count,
        COALESCE(budget, 0) AS budget,
        COALESCE(revenue, 0) AS revenue,
        runtime,
        status,
        tagline,
        
        -- Calculate derived metrics
        CASE 
            WHEN budget > 0 THEN ROUND((revenue - budget) / budget * 100, 2)
            ELSE NULL 
        END AS roi_percentage,
        
        CASE 
            WHEN revenue > 0 THEN revenue - budget
            ELSE NULL 
        END AS profit,
        
        -- Extract year and decade
        YEAR(release_date) AS release_year,
        FLOOR(YEAR(release_date) / 10) * 10 AS release_decade,
        
        -- Store JSON fields
        genres,
        production_companies,
        loaded_at
        
    FROM source
    WHERE id IS NOT NULL
      AND title IS NOT NULL
      AND release_date IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m13:49:08.022165 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:08.443374 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:49:08.450124 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.stg_credits (execute): 13:49:07.061674 => 13:49:08.449604
[0m13:49:08.451162 [debug] [Thread-3 (]: On model.tmdb_analytics.stg_credits: Close
[0m13:49:08.638103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:49:08.644324 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_company (execute): 13:49:07.088836 => 13:49:08.643829
[0m13:49:08.645314 [debug] [Thread-1 (]: On model.tmdb_analytics.dim_company: Close
[0m13:49:08.669546 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a711af0>]}
[0m13:49:08.670375 [info ] [Thread-3 (]: 3 of 9 OK created sql view model ANALYTICS_staging.stg_credits ................. [[32mSUCCESS 1[0m in 1.62s]
[0m13:49:08.671326 [debug] [Thread-3 (]: Finished running node model.tmdb_analytics.stg_credits
[0m13:49:08.671997 [debug] [Thread-3 (]: Began running node model.tmdb_analytics.dim_genre
[0m13:49:08.672700 [info ] [Thread-3 (]: 6 of 9 START sql table model ANALYTICS_analytics.dim_genre ..................... [RUN]
[0m13:49:08.673528 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.stg_credits, now model.tmdb_analytics.dim_genre)
[0m13:49:08.673919 [debug] [Thread-3 (]: Began compiling node model.tmdb_analytics.dim_genre
[0m13:49:08.677658 [debug] [Thread-3 (]: Writing injected SQL for node "model.tmdb_analytics.dim_genre"
[0m13:49:08.678530 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.dim_genre (compile): 13:49:08.674151 => 13:49:08.678336
[0m13:49:08.678837 [debug] [Thread-3 (]: Began executing node model.tmdb_analytics.dim_genre
[0m13:49:08.681215 [debug] [Thread-3 (]: Writing runtime sql for node "model.tmdb_analytics.dim_genre"
[0m13:49:08.682108 [debug] [Thread-3 (]: Using snowflake connection "model.tmdb_analytics.dim_genre"
[0m13:49:08.682389 [debug] [Thread-3 (]: On model.tmdb_analytics.dim_genre: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_genre"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_genre
         as
        (-- Dimension table for genres
-- SCD Type 1 (overwrite)



WITH genres AS (
    SELECT * FROM TMDB_DW.ANALYTICS_staging.stg_genres
),

final AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY genre_id) AS genre_key,
        genre_id,
        genre_name,
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
    FROM genres
)

SELECT * FROM final
        );
[0m13:49:08.682664 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:08.690236 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:49:08.692073 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_time (execute): 13:49:07.073645 => 13:49:08.691926
[0m13:49:08.692705 [debug] [Thread-2 (]: On model.tmdb_analytics.dim_time: Close
[0m13:49:08.695840 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:49:08.698391 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_movies (execute): 13:49:08.019189 => 13:49:08.698248
[0m13:49:08.700464 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_movies: Close
[0m13:49:08.861246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b2cc0>]}
[0m13:49:08.861761 [info ] [Thread-1 (]: 1 of 9 OK created sql table model ANALYTICS_analytics.dim_company .............. [[32mSUCCESS 1[0m in 1.82s]
[0m13:49:08.862195 [debug] [Thread-1 (]: Finished running node model.tmdb_analytics.dim_company
[0m13:49:08.862495 [debug] [Thread-1 (]: Began running node model.tmdb_analytics.dim_person
[0m13:49:08.862859 [info ] [Thread-1 (]: 7 of 9 START sql table model ANALYTICS_analytics.dim_person .................... [RUN]
[0m13:49:08.863386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.dim_company, now model.tmdb_analytics.dim_person)
[0m13:49:08.863638 [debug] [Thread-1 (]: Began compiling node model.tmdb_analytics.dim_person
[0m13:49:08.865873 [debug] [Thread-1 (]: Writing injected SQL for node "model.tmdb_analytics.dim_person"
[0m13:49:08.866427 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_person (compile): 13:49:08.863788 => 13:49:08.866281
[0m13:49:08.866671 [debug] [Thread-1 (]: Began executing node model.tmdb_analytics.dim_person
[0m13:49:08.868830 [debug] [Thread-1 (]: Writing runtime sql for node "model.tmdb_analytics.dim_person"
[0m13:49:08.869662 [debug] [Thread-1 (]: Using snowflake connection "model.tmdb_analytics.dim_person"
[0m13:49:08.869897 [debug] [Thread-1 (]: On model.tmdb_analytics.dim_person: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_person"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_person
         as
        (-- Dimension table for people (actors, directors, crew)
-- SCD Type 1



WITH people AS (
    SELECT DISTINCT
        person_id,
        person_name,
        gender
    FROM TMDB_DW.ANALYTICS_staging.stg_credits
    WHERE person_id IS NOT NULL
),

final AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY person_id) AS person_key,
        person_id,
        person_name,
        CASE gender
            WHEN 0 THEN 'Not specified'
            WHEN 1 THEN 'Female'
            WHEN 2 THEN 'Male'
            WHEN 3 THEN 'Non-binary'
            ELSE 'Unknown'
        END AS gender_description,
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
    FROM people
)

SELECT * FROM final
        );
[0m13:49:08.870114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:08.921027 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f03b30>]}
[0m13:49:08.921464 [info ] [Thread-4 (]: 5 of 9 OK created sql view model ANALYTICS_staging.stg_movies .................. [[32mSUCCESS 1[0m in 0.91s]
[0m13:49:08.921839 [debug] [Thread-4 (]: Finished running node model.tmdb_analytics.stg_movies
[0m13:49:09.109285 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a711700>]}
[0m13:49:09.109938 [info ] [Thread-2 (]: 2 of 9 OK created sql table model ANALYTICS_analytics.dim_time ................. [[32mSUCCESS 1[0m in 2.06s]
[0m13:49:09.110462 [debug] [Thread-2 (]: Finished running node model.tmdb_analytics.dim_time
[0m13:49:10.230839 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:49:10.236153 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.dim_genre (execute): 13:49:08.679024 => 13:49:10.235852
[0m13:49:10.236758 [debug] [Thread-3 (]: On model.tmdb_analytics.dim_genre: Close
[0m13:49:10.302598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:49:10.306961 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_person (execute): 13:49:08.866812 => 13:49:10.306581
[0m13:49:10.307640 [debug] [Thread-1 (]: On model.tmdb_analytics.dim_person: Close
[0m13:49:10.448007 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a710ad0>]}
[0m13:49:10.449730 [info ] [Thread-3 (]: 6 of 9 OK created sql table model ANALYTICS_analytics.dim_genre ................ [[32mSUCCESS 1[0m in 1.77s]
[0m13:49:10.450747 [debug] [Thread-3 (]: Finished running node model.tmdb_analytics.dim_genre
[0m13:49:10.451515 [debug] [Thread-4 (]: Began running node model.tmdb_analytics.fact_movie
[0m13:49:10.452228 [info ] [Thread-4 (]: 8 of 9 START sql table model ANALYTICS_analytics.fact_movie .................... [RUN]
[0m13:49:10.453124 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.stg_movies, now model.tmdb_analytics.fact_movie)
[0m13:49:10.453427 [debug] [Thread-4 (]: Began compiling node model.tmdb_analytics.fact_movie
[0m13:49:10.457115 [debug] [Thread-4 (]: Writing injected SQL for node "model.tmdb_analytics.fact_movie"
[0m13:49:10.457923 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.fact_movie (compile): 13:49:10.453596 => 13:49:10.457760
[0m13:49:10.458180 [debug] [Thread-4 (]: Began executing node model.tmdb_analytics.fact_movie
[0m13:49:10.459879 [debug] [Thread-4 (]: Writing runtime sql for node "model.tmdb_analytics.fact_movie"
[0m13:49:10.461824 [debug] [Thread-4 (]: Using snowflake connection "model.tmdb_analytics.fact_movie"
[0m13:49:10.462121 [debug] [Thread-4 (]: On model.tmdb_analytics.fact_movie: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.fact_movie"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.fact_movie
         as
        (-- Fact table for movies
-- Grain: One row per movie



WITH movies AS (
    SELECT * FROM TMDB_DW.ANALYTICS_staging.stg_movies
),

-- Extract genre relationships from VARIANT
movie_genres AS (
    SELECT
        m.movie_id,
        g.value:id::INTEGER AS genre_id
    FROM movies m,
    LATERAL FLATTEN(input => m.genres) g
),

-- Get primary genre (first genre listed)
primary_genres AS (
    SELECT
        movie_id,
        MIN(genre_id) AS primary_genre_id
    FROM movie_genres
    GROUP BY movie_id
),

-- Extract production company relationships
movie_companies AS (
    SELECT
        m.movie_id,
        pc.value:id::INTEGER AS company_id
    FROM movies m,
    LATERAL FLATTEN(input => m.production_companies) pc
),

-- Get primary production company
primary_companies AS (
    SELECT
        movie_id,
        MIN(company_id) AS primary_company_id
    FROM movie_companies
    GROUP BY movie_id
),

-- Join with dimensions
final AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY m.movie_id) AS movie_key,
        m.movie_id,
        
        -- Dimension foreign keys
        COALESCE(g.genre_key, -1) AS genre_key,
        COALESCE(c.company_key, -1) AS company_key,
        COALESCE(t.date_key, -1) AS release_date_key,
        
        -- Movie attributes
        m.title,
        m.original_title,
        m.overview,
        m.release_date,
        m.release_year,
        m.release_decade,
        m.status,
        
        -- Metrics
        m.budget,
        m.revenue,
        m.profit,
        m.roi_percentage,
        m.runtime,
        m.popularity,
        m.vote_average,
        m.vote_count,
        
        -- Categories
        CASE 
            WHEN m.budget >= 100000000 THEN 'Blockbuster'
            WHEN m.budget >= 50000000 THEN 'Major'
            WHEN m.budget >= 10000000 THEN 'Medium'
            WHEN m.budget > 0 THEN 'Low Budget'
            ELSE 'Unknown'
        END AS budget_category,
        
        CASE 
            WHEN m.vote_average >= 8.0 THEN 'Excellent'
            WHEN m.vote_average >= 7.0 THEN 'Good'
            WHEN m.vote_average >= 6.0 THEN 'Average'
            WHEN m.vote_average >= 5.0 THEN 'Below Average'
            ELSE 'Poor'
        END AS rating_category,
        
        -- Metadata
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
        
    FROM movies m
    LEFT JOIN primary_genres pg ON m.movie_id = pg.movie_id
    LEFT JOIN TMDB_DW.ANALYTICS_analytics.dim_genre g ON pg.primary_genre_id = g.genre_id
    LEFT JOIN primary_companies pc ON m.movie_id = pc.movie_id
    LEFT JOIN TMDB_DW.ANALYTICS_analytics.dim_company c ON pc.primary_company_id = c.company_id
    LEFT JOIN TMDB_DW.ANALYTICS_analytics.dim_time t ON TO_NUMBER(TO_CHAR(m.release_date, 'YYYYMMDD')) = t.date_key
)

SELECT * FROM final
        );
[0m13:49:10.462413 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:10.525305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2dbbf0>]}
[0m13:49:10.525860 [info ] [Thread-1 (]: 7 of 9 OK created sql table model ANALYTICS_analytics.dim_person ............... [[32mSUCCESS 1[0m in 1.66s]
[0m13:49:10.526293 [debug] [Thread-1 (]: Finished running node model.tmdb_analytics.dim_person
[0m13:49:11.511279 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c05f3d-0000-48f1-0011-92cb00039226
[0m13:49:11.512523 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [VARCHAR(5000)] for parameter 'input'
[0m13:49:11.513822 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.fact_movie (execute): 13:49:10.458306 => 13:49:11.513318
[0m13:49:11.514737 [debug] [Thread-4 (]: On model.tmdb_analytics.fact_movie: Close
[0m13:49:11.735448 [debug] [Thread-4 (]: Database Error in model fact_movie (models/facts/fact_movie.sql)
  001007 (22023): SQL compilation error:
  invalid type [VARCHAR(5000)] for parameter 'input'
  compiled Code at target/run/tmdb_analytics/models/facts/fact_movie.sql
[0m13:49:11.736176 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa83c64-94ad-49aa-a149-21bc8a6ef53f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a40fd70>]}
[0m13:49:11.736714 [error] [Thread-4 (]: 8 of 9 ERROR creating sql table model ANALYTICS_analytics.fact_movie ........... [[31mERROR[0m in 1.28s]
[0m13:49:11.737145 [debug] [Thread-4 (]: Finished running node model.tmdb_analytics.fact_movie
[0m13:49:11.738308 [debug] [Thread-3 (]: Began running node model.tmdb_analytics.fact_credit
[0m13:49:11.738883 [info ] [Thread-3 (]: 9 of 9 SKIP relation ANALYTICS_analytics.fact_credit ........................... [[33mSKIP[0m]
[0m13:49:11.739272 [debug] [Thread-3 (]: Finished running node model.tmdb_analytics.fact_credit
[0m13:49:11.740643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:11.740884 [debug] [MainThread]: Connection 'model.tmdb_analytics.dim_person' was properly closed.
[0m13:49:11.741072 [debug] [MainThread]: Connection 'model.tmdb_analytics.dim_time' was properly closed.
[0m13:49:11.741242 [debug] [MainThread]: Connection 'model.tmdb_analytics.dim_genre' was properly closed.
[0m13:49:11.741414 [debug] [MainThread]: Connection 'model.tmdb_analytics.fact_movie' was properly closed.
[0m13:49:11.741646 [info ] [MainThread]: 
[0m13:49:11.741879 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 13.54 seconds (13.54s).
[0m13:49:11.742862 [debug] [MainThread]: Command end result
[0m13:49:11.749466 [info ] [MainThread]: 
[0m13:49:11.749700 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:49:11.749883 [info ] [MainThread]: 
[0m13:49:11.750071 [error] [MainThread]:   Database Error in model fact_movie (models/facts/fact_movie.sql)
  001007 (22023): SQL compilation error:
  invalid type [VARCHAR(5000)] for parameter 'input'
  compiled Code at target/run/tmdb_analytics/models/facts/fact_movie.sql
[0m13:49:11.750261 [info ] [MainThread]: 
[0m13:49:11.750448 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=1 TOTAL=9
[0m13:49:11.752666 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.337097, "process_user_time": 2.55377, "process_kernel_time": 0.381545, "process_mem_max_rss": "226934784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:49:11.752949 [debug] [MainThread]: Command `dbt run` failed at 13:49:11.752884 after 14.34 seconds
[0m13:49:11.753141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105985bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a495eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566e9c0>]}
[0m13:49:11.753333 [debug] [MainThread]: Flushing usage events
[0m13:53:20.636304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054105c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054358e0>]}


============================== 13:53:20.638741 | d0c5c601-9cad-42a8-97c3-f4d5974405c2 ==============================
[0m13:53:20.638741 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:53:20.638992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:53:21.073911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105412c30>]}
[0m13:53:21.092603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7c470>]}
[0m13:53:21.093012 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m13:53:21.103276 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:53:21.103707 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:53:21.103887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10948df40>]}
[0m13:53:21.589254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10959d160>]}
[0m13:53:21.595799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b74d0>]}
[0m13:53:21.596023 [info ] [MainThread]: Found 9 models, 32 tests, 4 sources, 0 exposures, 0 metrics, 460 macros, 0 groups, 0 semantic models
[0m13:53:21.596194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10974d2b0>]}
[0m13:53:21.597251 [info ] [MainThread]: 
[0m13:53:21.597589 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:53:21.598227 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW'
[0m13:53:21.598556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW'
[0m13:53:21.604043 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW"
[0m13:53:21.604826 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW"
[0m13:53:21.604949 [debug] [ThreadPool]: On list_TMDB_DW: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW"} */
show terse schemas in database TMDB_DW
    limit 10000
[0m13:53:21.605061 [debug] [ThreadPool]: On list_TMDB_DW: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW"} */
show terse schemas in database TMDB_DW
    limit 10000
[0m13:53:21.605167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:21.605265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:25.232018 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 4.0 seconds
[0m13:53:25.235600 [debug] [ThreadPool]: On list_TMDB_DW: Close
[0m13:53:25.240932 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 4.0 seconds
[0m13:53:25.242415 [debug] [ThreadPool]: On list_TMDB_DW: Close
[0m13:53:25.467989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TMDB_DW, now list_TMDB_DW_ANALYTICS_staging)
[0m13:53:25.469162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TMDB_DW, now list_TMDB_DW_ANALYTICS_analytics)
[0m13:53:25.478206 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_staging"
[0m13:53:25.479973 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_analytics"
[0m13:53:25.480263 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_staging"} */
show objects in TMDB_DW.ANALYTICS_staging limit 10000
[0m13:53:25.480542 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_analytics"} */
show objects in TMDB_DW.ANALYTICS_analytics limit 10000
[0m13:53:25.480823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:25.481070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:28.721488 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m13:53:28.724598 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: Close
[0m13:53:28.762999 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m13:53:28.766428 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: Close
[0m13:53:28.986512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c5dc0>]}
[0m13:53:28.989114 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:53:28.989913 [info ] [MainThread]: 
[0m13:53:28.993845 [debug] [Thread-1 (]: Began running node model.tmdb_analytics.dim_company
[0m13:53:28.994304 [debug] [Thread-2 (]: Began running node model.tmdb_analytics.dim_time
[0m13:53:28.994813 [info ] [Thread-1 (]: 1 of 9 START sql table model ANALYTICS_analytics.dim_company ................... [RUN]
[0m13:53:28.995262 [debug] [Thread-3 (]: Began running node model.tmdb_analytics.stg_credits
[0m13:53:28.995882 [info ] [Thread-2 (]: 2 of 9 START sql table model ANALYTICS_analytics.dim_time ...................... [RUN]
[0m13:53:28.996385 [debug] [Thread-4 (]: Began running node model.tmdb_analytics.stg_genres
[0m13:53:28.997041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_staging, now model.tmdb_analytics.dim_company)
[0m13:53:28.997504 [info ] [Thread-3 (]: 3 of 9 START sql view model ANALYTICS_staging.stg_credits ...................... [RUN]
[0m13:53:28.998184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_analytics, now model.tmdb_analytics.dim_time)
[0m13:53:28.998595 [info ] [Thread-4 (]: 4 of 9 START sql view model ANALYTICS_staging.stg_genres ....................... [RUN]
[0m13:53:28.998932 [debug] [Thread-1 (]: Began compiling node model.tmdb_analytics.dim_company
[0m13:53:28.999558 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.tmdb_analytics.stg_credits'
[0m13:53:28.999825 [debug] [Thread-2 (]: Began compiling node model.tmdb_analytics.dim_time
[0m13:53:29.001889 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.tmdb_analytics.stg_genres'
[0m13:53:29.007876 [debug] [Thread-1 (]: Writing injected SQL for node "model.tmdb_analytics.dim_company"
[0m13:53:29.008166 [debug] [Thread-3 (]: Began compiling node model.tmdb_analytics.stg_credits
[0m13:53:29.010050 [debug] [Thread-2 (]: Writing injected SQL for node "model.tmdb_analytics.dim_time"
[0m13:53:29.010296 [debug] [Thread-4 (]: Began compiling node model.tmdb_analytics.stg_genres
[0m13:53:29.012128 [debug] [Thread-3 (]: Writing injected SQL for node "model.tmdb_analytics.stg_credits"
[0m13:53:29.014001 [debug] [Thread-4 (]: Writing injected SQL for node "model.tmdb_analytics.stg_genres"
[0m13:53:29.014577 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_company (compile): 13:53:29.002089 => 13:53:29.014428
[0m13:53:29.014821 [debug] [Thread-1 (]: Began executing node model.tmdb_analytics.dim_company
[0m13:53:29.021408 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_genres (compile): 13:53:29.012385 => 13:53:29.021285
[0m13:53:29.021642 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_time (compile): 13:53:29.008330 => 13:53:29.021519
[0m13:53:29.031732 [debug] [Thread-1 (]: Writing runtime sql for node "model.tmdb_analytics.dim_company"
[0m13:53:29.032019 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.stg_credits (compile): 13:53:29.010537 => 13:53:29.031899
[0m13:53:29.032248 [debug] [Thread-4 (]: Began executing node model.tmdb_analytics.stg_genres
[0m13:53:29.032460 [debug] [Thread-2 (]: Began executing node model.tmdb_analytics.dim_time
[0m13:53:29.032729 [debug] [Thread-3 (]: Began executing node model.tmdb_analytics.stg_credits
[0m13:53:29.043200 [debug] [Thread-4 (]: Writing runtime sql for node "model.tmdb_analytics.stg_genres"
[0m13:53:29.044462 [debug] [Thread-2 (]: Writing runtime sql for node "model.tmdb_analytics.dim_time"
[0m13:53:29.045828 [debug] [Thread-3 (]: Writing runtime sql for node "model.tmdb_analytics.stg_credits"
[0m13:53:29.046390 [debug] [Thread-4 (]: Using snowflake connection "model.tmdb_analytics.stg_genres"
[0m13:53:29.047089 [debug] [Thread-2 (]: Using snowflake connection "model.tmdb_analytics.dim_time"
[0m13:53:29.047245 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_genres: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.stg_genres"} */
create or replace   view TMDB_DW.ANALYTICS_staging.stg_genres
  
   as (
    -- Staging model for genres

WITH source AS (
    SELECT * FROM TMDB_DW.RAW.raw_genres
)

SELECT
    id AS genre_id,
    TRIM(name) AS genre_name,
    loaded_at
FROM source
WHERE id IS NOT NULL
  );
[0m13:53:29.047634 [debug] [Thread-1 (]: Using snowflake connection "model.tmdb_analytics.dim_company"
[0m13:53:29.048101 [debug] [Thread-3 (]: Using snowflake connection "model.tmdb_analytics.stg_credits"
[0m13:53:29.048279 [debug] [Thread-2 (]: On model.tmdb_analytics.dim_time: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_time"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_time
         as
        (-- Dimension table for time
-- Pre-populated date dimension



WITH date_spine AS (
    -- Generate dates from 1900 to 2030
    SELECT
        DATEADD(DAY, SEQ4(), '1900-01-01'::DATE) AS date_day
    FROM TABLE(GENERATOR(ROWCOUNT => 47482))
),

final AS (
    SELECT
        TO_NUMBER(TO_CHAR(date_day, 'YYYYMMDD')) AS date_key,
        date_day AS full_date,
        YEAR(date_day) AS year,
        QUARTER(date_day) AS quarter,
        MONTH(date_day) AS month,
        MONTHNAME(date_day) AS month_name,
        DAY(date_day) AS day,
        DAYOFWEEK(date_day) AS day_of_week,
        DAYNAME(date_day) AS day_name,
        WEEKOFYEAR(date_day) AS week_of_year,
        FLOOR(YEAR(date_day) / 10) * 10 AS decade,
        
        CASE 
            WHEN DAYOFWEEK(date_day) IN (0, 6) THEN TRUE 
            ELSE FALSE 
        END AS is_weekend,
        
        CASE 
            WHEN MONTH(date_day) IN (6, 7, 8) THEN 'Summer'
            WHEN MONTH(date_day) IN (9, 10, 11) THEN 'Fall'
            WHEN MONTH(date_day) IN (12, 1, 2) THEN 'Winter'
            ELSE 'Spring'
        END AS season
        
    FROM date_spine
)

SELECT * FROM final
        );
[0m13:53:29.048452 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:53:29.048624 [debug] [Thread-1 (]: On model.tmdb_analytics.dim_company: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_company"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_company
         as
        (-- Dimension table for production companies
-- SCD Type 1



WITH companies AS (
    SELECT * FROM TMDB_DW.RAW.raw_companies
),

final AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY id) AS company_key,
        id AS company_id,
        name AS company_name,
        origin_country,
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
    FROM companies
    WHERE id IS NOT NULL
)

SELECT * FROM final
        );
[0m13:53:29.048826 [debug] [Thread-3 (]: On model.tmdb_analytics.stg_credits: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.stg_credits"} */
create or replace   view TMDB_DW.ANALYTICS_staging.stg_credits
  
   as (
    -- Staging model for credits
-- Separates cast and crew

WITH source AS (
    SELECT * FROM TMDB_DW.RAW.raw_credits
),

cleaned AS (
    SELECT
        credit_id,
        movie_id,
        person_id,
        TRIM(name) AS person_name,
        TRIM(character) AS character_name,
        TRIM(job) AS job_title,
        TRIM(department) AS department,
        credit_type,
        gender,
        cast_order,
        
        -- Flag key roles
        CASE WHEN job_title = 'Director' THEN TRUE ELSE FALSE END AS is_director,
        CASE WHEN credit_type = 'cast' AND cast_order <= 5 THEN TRUE ELSE FALSE END AS is_lead_actor,
        
        loaded_at
        
    FROM source
    WHERE credit_id IS NOT NULL
      AND movie_id IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m13:53:29.048995 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:53:29.049342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:29.049558 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:53:29.729283 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:53:29.753073 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_genres (execute): 13:53:29.032860 => 13:53:29.752888
[0m13:53:29.753483 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_genres: Close
[0m13:53:29.969334 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a74d0>]}
[0m13:53:29.970673 [info ] [Thread-4 (]: 4 of 9 OK created sql view model ANALYTICS_staging.stg_genres .................. [[32mSUCCESS 1[0m in 0.97s]
[0m13:53:29.971462 [debug] [Thread-4 (]: Finished running node model.tmdb_analytics.stg_genres
[0m13:53:29.971948 [debug] [Thread-4 (]: Began running node model.tmdb_analytics.stg_movies
[0m13:53:29.972845 [info ] [Thread-4 (]: 5 of 9 START sql view model ANALYTICS_staging.stg_movies ....................... [RUN]
[0m13:53:29.973943 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.stg_genres, now model.tmdb_analytics.stg_movies)
[0m13:53:29.974397 [debug] [Thread-4 (]: Began compiling node model.tmdb_analytics.stg_movies
[0m13:53:29.977541 [debug] [Thread-4 (]: Writing injected SQL for node "model.tmdb_analytics.stg_movies"
[0m13:53:29.978315 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_movies (compile): 13:53:29.974641 => 13:53:29.978110
[0m13:53:29.978634 [debug] [Thread-4 (]: Began executing node model.tmdb_analytics.stg_movies
[0m13:53:29.981861 [debug] [Thread-4 (]: Writing runtime sql for node "model.tmdb_analytics.stg_movies"
[0m13:53:29.983285 [debug] [Thread-4 (]: Using snowflake connection "model.tmdb_analytics.stg_movies"
[0m13:53:29.983601 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_movies: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.stg_movies"} */
create or replace   view TMDB_DW.ANALYTICS_staging.stg_movies
  
   as (
    -- Staging model for movies
-- Cleans and standardizes raw movie data

WITH source AS (
    SELECT * FROM TMDB_DW.RAW.raw_movies
),

cleaned AS (
    SELECT
        id AS movie_id,
        TRIM(title) AS title,
        TRIM(original_title) AS original_title,
        overview,
        TRY_CAST(release_date AS DATE) AS release_date,
        popularity,
        vote_average,
        vote_count,
        COALESCE(budget, 0) AS budget,
        COALESCE(revenue, 0) AS revenue,
        runtime,
        status,
        tagline,
        
        -- Calculate derived metrics
        CASE 
            WHEN budget > 0 THEN ROUND((revenue - budget) / budget * 100, 2)
            ELSE NULL 
        END AS roi_percentage,
        
        CASE 
            WHEN revenue > 0 THEN revenue - budget
            ELSE NULL 
        END AS profit,
        
        -- Extract year and decade
        YEAR(release_date) AS release_year,
        FLOOR(YEAR(release_date) / 10) * 10 AS release_decade,
        
        -- Store JSON fields
        genres,
        production_companies,
        loaded_at
        
    FROM source
    WHERE id IS NOT NULL
      AND title IS NOT NULL
      AND release_date IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m13:53:29.983910 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:30.461446 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:53:30.465645 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.stg_credits (execute): 13:53:29.044589 => 13:53:30.465407
[0m13:53:30.466297 [debug] [Thread-3 (]: On model.tmdb_analytics.stg_credits: Close
[0m13:53:30.670088 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:53:30.674841 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_movies (execute): 13:53:29.978817 => 13:53:30.674615
[0m13:53:30.675371 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_movies: Close
[0m13:53:30.690613 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e69c10>]}
[0m13:53:30.691348 [info ] [Thread-3 (]: 3 of 9 OK created sql view model ANALYTICS_staging.stg_credits ................. [[32mSUCCESS 1[0m in 1.69s]
[0m13:53:30.692011 [debug] [Thread-3 (]: Finished running node model.tmdb_analytics.stg_credits
[0m13:53:30.692480 [debug] [Thread-3 (]: Began running node model.tmdb_analytics.dim_genre
[0m13:53:30.693152 [info ] [Thread-3 (]: 6 of 9 START sql table model ANALYTICS_analytics.dim_genre ..................... [RUN]
[0m13:53:30.693891 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.stg_credits, now model.tmdb_analytics.dim_genre)
[0m13:53:30.694244 [debug] [Thread-3 (]: Began compiling node model.tmdb_analytics.dim_genre
[0m13:53:30.697602 [debug] [Thread-3 (]: Writing injected SQL for node "model.tmdb_analytics.dim_genre"
[0m13:53:30.698325 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.dim_genre (compile): 13:53:30.694445 => 13:53:30.698161
[0m13:53:30.698594 [debug] [Thread-3 (]: Began executing node model.tmdb_analytics.dim_genre
[0m13:53:30.700742 [debug] [Thread-3 (]: Writing runtime sql for node "model.tmdb_analytics.dim_genre"
[0m13:53:30.701601 [debug] [Thread-3 (]: Using snowflake connection "model.tmdb_analytics.dim_genre"
[0m13:53:30.701896 [debug] [Thread-3 (]: On model.tmdb_analytics.dim_genre: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_genre"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_genre
         as
        (-- Dimension table for genres
-- SCD Type 1 (overwrite)



WITH genres AS (
    SELECT * FROM TMDB_DW.ANALYTICS_staging.stg_genres
),

final AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY genre_id) AS genre_key,
        genre_id,
        genre_name,
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
    FROM genres
)

SELECT * FROM final
        );
[0m13:53:30.702163 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:53:30.828437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:53:30.830833 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_company (execute): 13:53:29.015065 => 13:53:30.830656
[0m13:53:30.831115 [debug] [Thread-1 (]: On model.tmdb_analytics.dim_company: Close
[0m13:53:30.891344 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b13530>]}
[0m13:53:30.892006 [info ] [Thread-4 (]: 5 of 9 OK created sql view model ANALYTICS_staging.stg_movies .................. [[32mSUCCESS 1[0m in 0.92s]
[0m13:53:30.892477 [debug] [Thread-4 (]: Finished running node model.tmdb_analytics.stg_movies
[0m13:53:30.892796 [debug] [Thread-4 (]: Began running node model.tmdb_analytics.dim_person
[0m13:53:30.893217 [info ] [Thread-4 (]: 7 of 9 START sql table model ANALYTICS_analytics.dim_person .................... [RUN]
[0m13:53:30.893863 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.stg_movies, now model.tmdb_analytics.dim_person)
[0m13:53:30.894160 [debug] [Thread-4 (]: Began compiling node model.tmdb_analytics.dim_person
[0m13:53:30.897008 [debug] [Thread-4 (]: Writing injected SQL for node "model.tmdb_analytics.dim_person"
[0m13:53:30.897665 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.dim_person (compile): 13:53:30.894335 => 13:53:30.897518
[0m13:53:30.897897 [debug] [Thread-4 (]: Began executing node model.tmdb_analytics.dim_person
[0m13:53:30.900883 [debug] [Thread-4 (]: Writing runtime sql for node "model.tmdb_analytics.dim_person"
[0m13:53:30.901806 [debug] [Thread-4 (]: Using snowflake connection "model.tmdb_analytics.dim_person"
[0m13:53:30.902043 [debug] [Thread-4 (]: On model.tmdb_analytics.dim_person: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_person"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_person
         as
        (-- Dimension table for people (actors, directors, crew)
-- SCD Type 1



WITH people AS (
    SELECT DISTINCT
        person_id,
        person_name,
        gender
    FROM TMDB_DW.ANALYTICS_staging.stg_credits
    WHERE person_id IS NOT NULL
),

final AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY person_id) AS person_key,
        person_id,
        person_name,
        CASE gender
            WHEN 0 THEN 'Not specified'
            WHEN 1 THEN 'Female'
            WHEN 2 THEN 'Male'
            WHEN 3 THEN 'Non-binary'
            ELSE 'Unknown'
        END AS gender_description,
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
    FROM people
)

SELECT * FROM final
        );
[0m13:53:30.902261 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:30.910314 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:53:30.912825 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_time (execute): 13:53:29.043335 => 13:53:30.912686
[0m13:53:30.913752 [debug] [Thread-2 (]: On model.tmdb_analytics.dim_time: Close
[0m13:53:31.035169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8bbf80>]}
[0m13:53:31.035649 [info ] [Thread-1 (]: 1 of 9 OK created sql table model ANALYTICS_analytics.dim_company .............. [[32mSUCCESS 1[0m in 2.04s]
[0m13:53:31.036007 [debug] [Thread-1 (]: Finished running node model.tmdb_analytics.dim_company
[0m13:53:31.112644 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b9520>]}
[0m13:53:31.113294 [info ] [Thread-2 (]: 2 of 9 OK created sql table model ANALYTICS_analytics.dim_time ................. [[32mSUCCESS 1[0m in 2.11s]
[0m13:53:31.113811 [debug] [Thread-2 (]: Finished running node model.tmdb_analytics.dim_time
[0m13:53:32.252550 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:53:32.256378 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.dim_genre (execute): 13:53:30.698764 => 13:53:32.255978
[0m13:53:32.256954 [debug] [Thread-3 (]: On model.tmdb_analytics.dim_genre: Close
[0m13:53:32.482025 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8e8680>]}
[0m13:53:32.483442 [info ] [Thread-3 (]: 6 of 9 OK created sql table model ANALYTICS_analytics.dim_genre ................ [[32mSUCCESS 1[0m in 1.79s]
[0m13:53:32.484351 [debug] [Thread-3 (]: Finished running node model.tmdb_analytics.dim_genre
[0m13:53:32.485122 [debug] [Thread-1 (]: Began running node model.tmdb_analytics.fact_movie
[0m13:53:32.485712 [info ] [Thread-1 (]: 8 of 9 START sql table model ANALYTICS_analytics.fact_movie .................... [RUN]
[0m13:53:32.486865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.dim_company, now model.tmdb_analytics.fact_movie)
[0m13:53:32.487482 [debug] [Thread-1 (]: Began compiling node model.tmdb_analytics.fact_movie
[0m13:53:32.491704 [debug] [Thread-1 (]: Writing injected SQL for node "model.tmdb_analytics.fact_movie"
[0m13:53:32.492717 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.fact_movie (compile): 13:53:32.487814 => 13:53:32.492487
[0m13:53:32.493072 [debug] [Thread-1 (]: Began executing node model.tmdb_analytics.fact_movie
[0m13:53:32.495532 [debug] [Thread-1 (]: Writing runtime sql for node "model.tmdb_analytics.fact_movie"
[0m13:53:32.498200 [debug] [Thread-1 (]: Using snowflake connection "model.tmdb_analytics.fact_movie"
[0m13:53:32.498756 [debug] [Thread-1 (]: On model.tmdb_analytics.fact_movie: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.fact_movie"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.fact_movie
         as
        (

WITH movies AS (
    SELECT * FROM TMDB_DW.ANALYTICS_staging.stg_movies
),

genres AS (
    SELECT * FROM TMDB_DW.ANALYTICS_analytics.dim_genre
),

companies AS (
    SELECT * FROM TMDB_DW.ANALYTICS_analytics.dim_company
),

time_dim AS (
    SELECT * FROM TMDB_DW.ANALYTICS_analytics.dim_time
),

-- Extract primary genre from JSON string
movie_genres AS (
    SELECT
        m.movie_id,
        TRY_PARSE_JSON(m.genres) AS genres_json
    FROM movies m
),

primary_genre AS (
    SELECT
        movie_id,
        TRY_CAST(genres_json[0]:id AS INTEGER) AS genre_id
    FROM movie_genres
    WHERE genres_json IS NOT NULL
),

-- Extract primary company from JSON string
movie_companies AS (
    SELECT
        m.movie_id,
        TRY_PARSE_JSON(m.production_companies) AS companies_json
    FROM movies m
),

primary_company AS (
    SELECT
        movie_id,
        TRY_CAST(companies_json[0]:id AS INTEGER) AS company_id
    FROM movie_companies
    WHERE companies_json IS NOT NULL
),

final AS (
    SELECT
        -- Surrogate key
        ROW_NUMBER() OVER (ORDER BY m.movie_id) AS movie_key,
        
        -- Natural key
        m.movie_id,
        
        -- Foreign keys
        COALESCE(g.genre_key, -1) AS genre_key,
        COALESCE(c.company_key, -1) AS company_key,
        COALESCE(t.date_key, -1) AS release_date_key,
        
        -- Descriptive attributes
        m.title,
        m.original_title,
        m.overview,
        m.release_year,
        m.release_decade,
        
        -- Measures
        m.budget,
        m.revenue,
        m.profit,
        m.roi_percentage,
        m.runtime,
        m.popularity,
        m.vote_average,
        m.vote_count,
        
        -- Categorizations
        CASE
            WHEN m.budget >= 100000000 THEN 'Blockbuster'
            WHEN m.budget >= 50000000 THEN 'Major'
            WHEN m.budget >= 10000000 THEN 'Medium'
            WHEN m.budget > 0 THEN 'Low Budget'
            ELSE 'Unknown'
        END AS budget_category,
        
        CASE
            WHEN m.vote_average >= 8.0 THEN 'Excellent'
            WHEN m.vote_average >= 7.0 THEN 'Good'
            WHEN m.vote_average >= 6.0 THEN 'Average'
            WHEN m.vote_average >= 5.0 THEN 'Below Average'
            ELSE 'Poor'
        END AS rating_category,
        
        -- Status flags
        CASE WHEN m.profit > 0 THEN TRUE ELSE FALSE END AS is_profitable,
        
        -- Timestamps
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
        
    FROM movies m
    LEFT JOIN primary_genre pg ON m.movie_id = pg.movie_id
    LEFT JOIN genres g ON pg.genre_id = g.genre_id
    LEFT JOIN primary_company pc ON m.movie_id = pc.movie_id
    LEFT JOIN companies c ON pc.company_id = c.company_id
    LEFT JOIN time_dim t ON m.release_date = t.full_date
)

SELECT * FROM final
        );
[0m13:53:32.499151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:32.856230 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:53:32.860439 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.dim_person (execute): 13:53:30.898038 => 13:53:32.860174
[0m13:53:32.860901 [debug] [Thread-4 (]: On model.tmdb_analytics.dim_person: Close
[0m13:53:33.080720 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab59310>]}
[0m13:53:33.082130 [info ] [Thread-4 (]: 7 of 9 OK created sql table model ANALYTICS_analytics.dim_person ............... [[32mSUCCESS 1[0m in 2.19s]
[0m13:53:33.082903 [debug] [Thread-4 (]: Finished running node model.tmdb_analytics.dim_person
[0m13:53:33.159321 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c05f41-0000-4762-0011-92cb0003a202
[0m13:53:33.160022 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001065 (22023): SQL compilation error:
Function TRY_CAST cannot be used with arguments of types VARIANT and NUMBER(38,0)
[0m13:53:33.160698 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.fact_movie (execute): 13:53:32.493267 => 13:53:33.160463
[0m13:53:33.161201 [debug] [Thread-1 (]: On model.tmdb_analytics.fact_movie: Close
[0m13:53:33.371176 [debug] [Thread-1 (]: Database Error in model fact_movie (models/facts/fact_movie.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types VARIANT and NUMBER(38,0)
  compiled Code at target/run/tmdb_analytics/models/facts/fact_movie.sql
[0m13:53:33.371823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c5c601-9cad-42a8-97c3-f4d5974405c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab59310>]}
[0m13:53:33.372504 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model ANALYTICS_analytics.fact_movie ........... [[31mERROR[0m in 0.89s]
[0m13:53:33.372970 [debug] [Thread-1 (]: Finished running node model.tmdb_analytics.fact_movie
[0m13:53:33.374235 [debug] [Thread-3 (]: Began running node model.tmdb_analytics.fact_credit
[0m13:53:33.374756 [info ] [Thread-3 (]: 9 of 9 SKIP relation ANALYTICS_analytics.fact_credit ........................... [[33mSKIP[0m]
[0m13:53:33.375366 [debug] [Thread-3 (]: Finished running node model.tmdb_analytics.fact_credit
[0m13:53:33.377113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:33.377475 [debug] [MainThread]: Connection 'model.tmdb_analytics.fact_movie' was properly closed.
[0m13:53:33.377719 [debug] [MainThread]: Connection 'model.tmdb_analytics.dim_time' was properly closed.
[0m13:53:33.377932 [debug] [MainThread]: Connection 'model.tmdb_analytics.dim_genre' was properly closed.
[0m13:53:33.378274 [debug] [MainThread]: Connection 'model.tmdb_analytics.dim_person' was properly closed.
[0m13:53:33.378562 [info ] [MainThread]: 
[0m13:53:33.378782 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 11.78 seconds (11.78s).
[0m13:53:33.379598 [debug] [MainThread]: Command end result
[0m13:53:33.388134 [info ] [MainThread]: 
[0m13:53:33.388507 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:53:33.388697 [info ] [MainThread]: 
[0m13:53:33.388875 [error] [MainThread]:   Database Error in model fact_movie (models/facts/fact_movie.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types VARIANT and NUMBER(38,0)
  compiled Code at target/run/tmdb_analytics/models/facts/fact_movie.sql
[0m13:53:33.389053 [info ] [MainThread]: 
[0m13:53:33.389297 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=1 TOTAL=9
[0m13:53:33.392336 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.781006, "process_user_time": 2.512613, "process_kernel_time": 0.423248, "process_mem_max_rss": "230326272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:53:33.392842 [debug] [MainThread]: Command `dbt run` failed at 13:53:33.392725 after 12.78 seconds
[0m13:53:33.393156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105435b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054105c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984ede0>]}
[0m13:53:33.393453 [debug] [MainThread]: Flushing usage events
[0m13:56:02.867127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076af890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073582f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076cd820>]}


============================== 13:56:02.869295 | 6ddd56ed-5e6c-4e26-a896-c9f626138387 ==============================
[0m13:56:02.869295 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:56:02.869544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:56:03.231632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c0ef00>]}
[0m13:56:03.250130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113da2ae0>]}
[0m13:56:03.250592 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m13:56:03.258290 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:56:03.258708 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:56:03.258868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fb3e00>]}
[0m13:56:03.724538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145ae1e0>]}
[0m13:56:03.729548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11419c350>]}
[0m13:56:03.729718 [info ] [MainThread]: Found 9 models, 32 tests, 4 sources, 0 exposures, 0 metrics, 460 macros, 0 groups, 0 semantic models
[0m13:56:03.729865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114103380>]}
[0m13:56:03.730719 [info ] [MainThread]: 
[0m13:56:03.731037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:56:03.731567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW'
[0m13:56:03.736328 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW"
[0m13:56:03.736588 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW'
[0m13:56:03.736737 [debug] [ThreadPool]: On list_TMDB_DW: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW"} */
show terse schemas in database TMDB_DW
    limit 10000
[0m13:56:03.737530 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW"
[0m13:56:03.737646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:03.737761 [debug] [ThreadPool]: On list_TMDB_DW: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW"} */
show terse schemas in database TMDB_DW
    limit 10000
[0m13:56:03.737910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:07.301425 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 4.0 seconds
[0m13:56:07.304467 [debug] [ThreadPool]: On list_TMDB_DW: Close
[0m13:56:07.310128 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 4.0 seconds
[0m13:56:07.311952 [debug] [ThreadPool]: On list_TMDB_DW: Close
[0m13:56:07.548899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TMDB_DW, now list_TMDB_DW_ANALYTICS_staging)
[0m13:56:07.550142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TMDB_DW, now list_TMDB_DW_ANALYTICS_analytics)
[0m13:56:07.559207 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_staging"
[0m13:56:07.561069 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_analytics"
[0m13:56:07.561379 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_staging"} */
show objects in TMDB_DW.ANALYTICS_staging limit 10000
[0m13:56:07.561633 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_analytics"} */
show objects in TMDB_DW.ANALYTICS_analytics limit 10000
[0m13:56:07.561884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:07.562102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:10.168471 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m13:56:10.171965 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: Close
[0m13:56:10.177157 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m13:56:10.179147 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: Close
[0m13:56:10.407980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11413a300>]}
[0m13:56:10.409118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:10.409510 [info ] [MainThread]: 
[0m13:56:10.412072 [debug] [Thread-1 (]: Began running node model.tmdb_analytics.dim_company
[0m13:56:10.412519 [debug] [Thread-2 (]: Began running node model.tmdb_analytics.dim_time
[0m13:56:10.412930 [debug] [Thread-3 (]: Began running node model.tmdb_analytics.stg_credits
[0m13:56:10.413308 [debug] [Thread-4 (]: Began running node model.tmdb_analytics.stg_genres
[0m13:56:10.413734 [info ] [Thread-1 (]: 1 of 9 START sql table model ANALYTICS_analytics.dim_company ................... [RUN]
[0m13:56:10.414161 [info ] [Thread-2 (]: 2 of 9 START sql table model ANALYTICS_analytics.dim_time ...................... [RUN]
[0m13:56:10.414537 [info ] [Thread-3 (]: 3 of 9 START sql view model ANALYTICS_staging.stg_credits ...................... [RUN]
[0m13:56:10.414894 [info ] [Thread-4 (]: 4 of 9 START sql view model ANALYTICS_staging.stg_genres ....................... [RUN]
[0m13:56:10.415503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_staging, now model.tmdb_analytics.dim_company)
[0m13:56:10.416042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_analytics, now model.tmdb_analytics.dim_time)
[0m13:56:10.416648 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.tmdb_analytics.stg_credits'
[0m13:56:10.418564 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.tmdb_analytics.stg_genres'
[0m13:56:10.418837 [debug] [Thread-1 (]: Began compiling node model.tmdb_analytics.dim_company
[0m13:56:10.419089 [debug] [Thread-2 (]: Began compiling node model.tmdb_analytics.dim_time
[0m13:56:10.419331 [debug] [Thread-3 (]: Began compiling node model.tmdb_analytics.stg_credits
[0m13:56:10.419578 [debug] [Thread-4 (]: Began compiling node model.tmdb_analytics.stg_genres
[0m13:56:10.425218 [debug] [Thread-1 (]: Writing injected SQL for node "model.tmdb_analytics.dim_company"
[0m13:56:10.427126 [debug] [Thread-2 (]: Writing injected SQL for node "model.tmdb_analytics.dim_time"
[0m13:56:10.428775 [debug] [Thread-3 (]: Writing injected SQL for node "model.tmdb_analytics.stg_credits"
[0m13:56:10.430274 [debug] [Thread-4 (]: Writing injected SQL for node "model.tmdb_analytics.stg_genres"
[0m13:56:10.431146 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.stg_credits (compile): 13:56:10.427305 => 13:56:10.430999
[0m13:56:10.431430 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_time (compile): 13:56:10.425412 => 13:56:10.431280
[0m13:56:10.431673 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_company (compile): 13:56:10.419764 => 13:56:10.431556
[0m13:56:10.431946 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_genres (compile): 13:56:10.428928 => 13:56:10.431827
[0m13:56:10.432143 [debug] [Thread-3 (]: Began executing node model.tmdb_analytics.stg_credits
[0m13:56:10.432360 [debug] [Thread-2 (]: Began executing node model.tmdb_analytics.dim_time
[0m13:56:10.432561 [debug] [Thread-1 (]: Began executing node model.tmdb_analytics.dim_company
[0m13:56:10.432762 [debug] [Thread-4 (]: Began executing node model.tmdb_analytics.stg_genres
[0m13:56:10.449117 [debug] [Thread-3 (]: Writing runtime sql for node "model.tmdb_analytics.stg_credits"
[0m13:56:10.459370 [debug] [Thread-2 (]: Writing runtime sql for node "model.tmdb_analytics.dim_time"
[0m13:56:10.460641 [debug] [Thread-1 (]: Writing runtime sql for node "model.tmdb_analytics.dim_company"
[0m13:56:10.462000 [debug] [Thread-4 (]: Writing runtime sql for node "model.tmdb_analytics.stg_genres"
[0m13:56:10.462802 [debug] [Thread-4 (]: Using snowflake connection "model.tmdb_analytics.stg_genres"
[0m13:56:10.463459 [debug] [Thread-3 (]: Using snowflake connection "model.tmdb_analytics.stg_credits"
[0m13:56:10.463909 [debug] [Thread-1 (]: Using snowflake connection "model.tmdb_analytics.dim_company"
[0m13:56:10.464074 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_genres: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.stg_genres"} */
create or replace   view TMDB_DW.ANALYTICS_staging.stg_genres
  
   as (
    -- Staging model for genres

WITH source AS (
    SELECT * FROM TMDB_DW.RAW.raw_genres
)

SELECT
    id AS genre_id,
    TRIM(name) AS genre_name,
    loaded_at
FROM source
WHERE id IS NOT NULL
  );
[0m13:56:10.464690 [debug] [Thread-2 (]: Using snowflake connection "model.tmdb_analytics.dim_time"
[0m13:56:10.464870 [debug] [Thread-3 (]: On model.tmdb_analytics.stg_credits: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.stg_credits"} */
create or replace   view TMDB_DW.ANALYTICS_staging.stg_credits
  
   as (
    -- Staging model for credits
-- Separates cast and crew

WITH source AS (
    SELECT * FROM TMDB_DW.RAW.raw_credits
),

cleaned AS (
    SELECT
        credit_id,
        movie_id,
        person_id,
        TRIM(name) AS person_name,
        TRIM(character) AS character_name,
        TRIM(job) AS job_title,
        TRIM(department) AS department,
        credit_type,
        gender,
        cast_order,
        
        -- Flag key roles
        CASE WHEN job_title = 'Director' THEN TRUE ELSE FALSE END AS is_director,
        CASE WHEN credit_type = 'cast' AND cast_order <= 5 THEN TRUE ELSE FALSE END AS is_lead_actor,
        
        loaded_at
        
    FROM source
    WHERE credit_id IS NOT NULL
      AND movie_id IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m13:56:10.465047 [debug] [Thread-1 (]: On model.tmdb_analytics.dim_company: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_company"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_company
         as
        (-- Dimension table for production companies
-- SCD Type 1



WITH companies AS (
    SELECT * FROM TMDB_DW.RAW.raw_companies
),

final AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY id) AS company_key,
        id AS company_id,
        name AS company_name,
        origin_country,
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
    FROM companies
    WHERE id IS NOT NULL
)

SELECT * FROM final
        );
[0m13:56:10.465201 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:56:10.465369 [debug] [Thread-2 (]: On model.tmdb_analytics.dim_time: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_time"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_time
         as
        (-- Dimension table for time
-- Pre-populated date dimension



WITH date_spine AS (
    -- Generate dates from 1900 to 2030
    SELECT
        DATEADD(DAY, SEQ4(), '1900-01-01'::DATE) AS date_day
    FROM TABLE(GENERATOR(ROWCOUNT => 47482))
),

final AS (
    SELECT
        TO_NUMBER(TO_CHAR(date_day, 'YYYYMMDD')) AS date_key,
        date_day AS full_date,
        YEAR(date_day) AS year,
        QUARTER(date_day) AS quarter,
        MONTH(date_day) AS month,
        MONTHNAME(date_day) AS month_name,
        DAY(date_day) AS day,
        DAYOFWEEK(date_day) AS day_of_week,
        DAYNAME(date_day) AS day_name,
        WEEKOFYEAR(date_day) AS week_of_year,
        FLOOR(YEAR(date_day) / 10) * 10 AS decade,
        
        CASE 
            WHEN DAYOFWEEK(date_day) IN (0, 6) THEN TRUE 
            ELSE FALSE 
        END AS is_weekend,
        
        CASE 
            WHEN MONTH(date_day) IN (6, 7, 8) THEN 'Summer'
            WHEN MONTH(date_day) IN (9, 10, 11) THEN 'Fall'
            WHEN MONTH(date_day) IN (12, 1, 2) THEN 'Winter'
            ELSE 'Spring'
        END AS season
        
    FROM date_spine
)

SELECT * FROM final
        );
[0m13:56:10.465531 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:56:10.465666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:10.465860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:56:11.139459 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:56:11.161944 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_genres (execute): 13:56:10.460761 => 13:56:11.161775
[0m13:56:11.162288 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_genres: Close
[0m13:56:11.368068 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147ce690>]}
[0m13:56:11.369675 [info ] [Thread-4 (]: 4 of 9 OK created sql view model ANALYTICS_staging.stg_genres .................. [[32mSUCCESS 1[0m in 0.95s]
[0m13:56:11.370666 [debug] [Thread-4 (]: Finished running node model.tmdb_analytics.stg_genres
[0m13:56:11.371293 [debug] [Thread-4 (]: Began running node model.tmdb_analytics.stg_movies
[0m13:56:11.372530 [info ] [Thread-4 (]: 5 of 9 START sql view model ANALYTICS_staging.stg_movies ....................... [RUN]
[0m13:56:11.373406 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.stg_genres, now model.tmdb_analytics.stg_movies)
[0m13:56:11.373746 [debug] [Thread-4 (]: Began compiling node model.tmdb_analytics.stg_movies
[0m13:56:11.376689 [debug] [Thread-4 (]: Writing injected SQL for node "model.tmdb_analytics.stg_movies"
[0m13:56:11.377578 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_movies (compile): 13:56:11.373944 => 13:56:11.377365
[0m13:56:11.377898 [debug] [Thread-4 (]: Began executing node model.tmdb_analytics.stg_movies
[0m13:56:11.381011 [debug] [Thread-4 (]: Writing runtime sql for node "model.tmdb_analytics.stg_movies"
[0m13:56:11.382425 [debug] [Thread-4 (]: Using snowflake connection "model.tmdb_analytics.stg_movies"
[0m13:56:11.382734 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_movies: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.stg_movies"} */
create or replace   view TMDB_DW.ANALYTICS_staging.stg_movies
  
   as (
    -- Staging model for movies
-- Cleans and standardizes raw movie data

WITH source AS (
    SELECT * FROM TMDB_DW.RAW.raw_movies
),

cleaned AS (
    SELECT
        id AS movie_id,
        TRIM(title) AS title,
        TRIM(original_title) AS original_title,
        overview,
        TRY_CAST(release_date AS DATE) AS release_date,
        popularity,
        vote_average,
        vote_count,
        COALESCE(budget, 0) AS budget,
        COALESCE(revenue, 0) AS revenue,
        runtime,
        status,
        tagline,
        
        -- Calculate derived metrics
        CASE 
            WHEN budget > 0 THEN ROUND((revenue - budget) / budget * 100, 2)
            ELSE NULL 
        END AS roi_percentage,
        
        CASE 
            WHEN revenue > 0 THEN revenue - budget
            ELSE NULL 
        END AS profit,
        
        -- Extract year and decade
        YEAR(release_date) AS release_year,
        FLOOR(YEAR(release_date) / 10) * 10 AS release_decade,
        
        -- Store JSON fields
        genres,
        production_companies,
        loaded_at
        
    FROM source
    WHERE id IS NOT NULL
      AND title IS NOT NULL
      AND release_date IS NOT NULL
)

SELECT * FROM cleaned
  );
[0m13:56:11.383028 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:56:11.797770 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:56:11.803074 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.stg_credits (execute): 13:56:10.432894 => 13:56:11.802814
[0m13:56:11.803667 [debug] [Thread-3 (]: On model.tmdb_analytics.stg_credits: Close
[0m13:56:12.025821 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115988da0>]}
[0m13:56:12.027235 [info ] [Thread-3 (]: 3 of 9 OK created sql view model ANALYTICS_staging.stg_credits ................. [[32mSUCCESS 1[0m in 1.61s]
[0m13:56:12.028322 [debug] [Thread-3 (]: Finished running node model.tmdb_analytics.stg_credits
[0m13:56:12.029135 [debug] [Thread-3 (]: Began running node model.tmdb_analytics.dim_genre
[0m13:56:12.030293 [info ] [Thread-3 (]: 6 of 9 START sql table model ANALYTICS_analytics.dim_genre ..................... [RUN]
[0m13:56:12.031258 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.stg_credits, now model.tmdb_analytics.dim_genre)
[0m13:56:12.031640 [debug] [Thread-3 (]: Began compiling node model.tmdb_analytics.dim_genre
[0m13:56:12.035326 [debug] [Thread-3 (]: Writing injected SQL for node "model.tmdb_analytics.dim_genre"
[0m13:56:12.036162 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.dim_genre (compile): 13:56:12.031852 => 13:56:12.035974
[0m13:56:12.036466 [debug] [Thread-3 (]: Began executing node model.tmdb_analytics.dim_genre
[0m13:56:12.038943 [debug] [Thread-3 (]: Writing runtime sql for node "model.tmdb_analytics.dim_genre"
[0m13:56:12.039888 [debug] [Thread-3 (]: Using snowflake connection "model.tmdb_analytics.dim_genre"
[0m13:56:12.040173 [debug] [Thread-3 (]: On model.tmdb_analytics.dim_genre: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_genre"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_genre
         as
        (-- Dimension table for genres
-- SCD Type 1 (overwrite)



WITH genres AS (
    SELECT * FROM TMDB_DW.ANALYTICS_staging.stg_genres
),

final AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY genre_id) AS genre_key,
        genre_id,
        genre_name,
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
    FROM genres
)

SELECT * FROM final
        );
[0m13:56:12.040440 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:56:12.160663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:56:12.162657 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_company (execute): 13:56:10.459504 => 13:56:12.162508
[0m13:56:12.162920 [debug] [Thread-1 (]: On model.tmdb_analytics.dim_company: Close
[0m13:56:12.370496 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:56:12.375570 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_time (execute): 13:56:10.449292 => 13:56:12.375294
[0m13:56:12.376539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159caae0>]}
[0m13:56:12.377152 [debug] [Thread-2 (]: On model.tmdb_analytics.dim_time: Close
[0m13:56:12.377843 [info ] [Thread-1 (]: 1 of 9 OK created sql table model ANALYTICS_analytics.dim_company .............. [[32mSUCCESS 1[0m in 1.96s]
[0m13:56:12.379421 [debug] [Thread-1 (]: Finished running node model.tmdb_analytics.dim_company
[0m13:56:12.380088 [debug] [Thread-1 (]: Began running node model.tmdb_analytics.dim_person
[0m13:56:12.380667 [info ] [Thread-1 (]: 7 of 9 START sql table model ANALYTICS_analytics.dim_person .................... [RUN]
[0m13:56:12.381403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.dim_company, now model.tmdb_analytics.dim_person)
[0m13:56:12.381750 [debug] [Thread-1 (]: Began compiling node model.tmdb_analytics.dim_person
[0m13:56:12.385220 [debug] [Thread-1 (]: Writing injected SQL for node "model.tmdb_analytics.dim_person"
[0m13:56:12.386206 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_person (compile): 13:56:12.381951 => 13:56:12.386019
[0m13:56:12.386503 [debug] [Thread-1 (]: Began executing node model.tmdb_analytics.dim_person
[0m13:56:12.388712 [debug] [Thread-1 (]: Writing runtime sql for node "model.tmdb_analytics.dim_person"
[0m13:56:12.389830 [debug] [Thread-1 (]: Using snowflake connection "model.tmdb_analytics.dim_person"
[0m13:56:12.390161 [debug] [Thread-1 (]: On model.tmdb_analytics.dim_person: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.dim_person"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.dim_person
         as
        (-- Dimension table for people (actors, directors, crew)
-- SCD Type 1



WITH people AS (
    SELECT DISTINCT
        person_id,
        person_name,
        gender
    FROM TMDB_DW.ANALYTICS_staging.stg_credits
    WHERE person_id IS NOT NULL
),

final AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY person_id) AS person_key,
        person_id,
        person_name,
        CASE gender
            WHEN 0 THEN 'Not specified'
            WHEN 1 THEN 'Female'
            WHEN 2 THEN 'Male'
            WHEN 3 THEN 'Non-binary'
            ELSE 'Unknown'
        END AS gender_description,
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
    FROM people
)

SELECT * FROM final
        );
[0m13:56:12.390429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:12.592340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214f9790>]}
[0m13:56:12.592953 [info ] [Thread-2 (]: 2 of 9 OK created sql table model ANALYTICS_analytics.dim_time ................. [[32mSUCCESS 1[0m in 2.18s]
[0m13:56:12.593466 [debug] [Thread-2 (]: Finished running node model.tmdb_analytics.dim_time
[0m13:56:12.660593 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:56:12.664439 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_movies (execute): 13:56:11.378077 => 13:56:12.664219
[0m13:56:12.664837 [debug] [Thread-4 (]: On model.tmdb_analytics.stg_movies: Close
[0m13:56:12.879757 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11597bc20>]}
[0m13:56:12.880989 [info ] [Thread-4 (]: 5 of 9 OK created sql view model ANALYTICS_staging.stg_movies .................. [[32mSUCCESS 1[0m in 1.51s]
[0m13:56:12.881701 [debug] [Thread-4 (]: Finished running node model.tmdb_analytics.stg_movies
[0m13:56:13.409746 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:56:13.414683 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.dim_genre (execute): 13:56:12.036649 => 13:56:13.414394
[0m13:56:13.415308 [debug] [Thread-3 (]: On model.tmdb_analytics.dim_genre: Close
[0m13:56:13.639410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:56:13.644130 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_person (execute): 13:56:12.386668 => 13:56:13.643854
[0m13:56:13.644758 [debug] [Thread-1 (]: On model.tmdb_analytics.dim_person: Close
[0m13:56:13.680446 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159a68a0>]}
[0m13:56:13.682261 [info ] [Thread-3 (]: 6 of 9 OK created sql table model ANALYTICS_analytics.dim_genre ................ [[32mSUCCESS 1[0m in 1.65s]
[0m13:56:13.683145 [debug] [Thread-3 (]: Finished running node model.tmdb_analytics.dim_genre
[0m13:56:13.683888 [debug] [Thread-2 (]: Began running node model.tmdb_analytics.fact_movie
[0m13:56:13.684504 [info ] [Thread-2 (]: 8 of 9 START sql table model ANALYTICS_analytics.fact_movie .................... [RUN]
[0m13:56:13.685320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.dim_time, now model.tmdb_analytics.fact_movie)
[0m13:56:13.685696 [debug] [Thread-2 (]: Began compiling node model.tmdb_analytics.fact_movie
[0m13:56:13.690337 [debug] [Thread-2 (]: Writing injected SQL for node "model.tmdb_analytics.fact_movie"
[0m13:56:13.691224 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.fact_movie (compile): 13:56:13.685925 => 13:56:13.691035
[0m13:56:13.691538 [debug] [Thread-2 (]: Began executing node model.tmdb_analytics.fact_movie
[0m13:56:13.693751 [debug] [Thread-2 (]: Writing runtime sql for node "model.tmdb_analytics.fact_movie"
[0m13:56:13.696294 [debug] [Thread-2 (]: Using snowflake connection "model.tmdb_analytics.fact_movie"
[0m13:56:13.696662 [debug] [Thread-2 (]: On model.tmdb_analytics.fact_movie: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.fact_movie"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.fact_movie
         as
        (

WITH movies AS (
    SELECT * FROM TMDB_DW.ANALYTICS_staging.stg_movies
),

genres AS (
    SELECT * FROM TMDB_DW.ANALYTICS_analytics.dim_genre
),

companies AS (
    SELECT * FROM TMDB_DW.ANALYTICS_analytics.dim_company
),

time_dim AS (
    SELECT * FROM TMDB_DW.ANALYTICS_analytics.dim_time
),

-- Extract primary genre from JSON string
movie_genres AS (
    SELECT
        m.movie_id,
        TRY_PARSE_JSON(m.genres) AS genres_json
    FROM movies m
),

primary_genre AS (
    SELECT
        movie_id,
        genres_json[0]:id::INTEGER AS genre_id
    FROM movie_genres
    WHERE genres_json IS NOT NULL
    AND ARRAY_SIZE(genres_json) > 0
),

-- Extract primary company from JSON string
movie_companies AS (
    SELECT
        m.movie_id,
        TRY_PARSE_JSON(m.production_companies) AS companies_json
    FROM movies m
),

primary_company AS (
    SELECT
        movie_id,
        companies_json[0]:id::INTEGER AS company_id
    FROM movie_companies
    WHERE companies_json IS NOT NULL
    AND ARRAY_SIZE(companies_json) > 0
),

final AS (
    SELECT
        -- Surrogate key
        ROW_NUMBER() OVER (ORDER BY m.movie_id) AS movie_key,
        
        -- Natural key
        m.movie_id,
        
        -- Foreign keys
        COALESCE(g.genre_key, -1) AS genre_key,
        COALESCE(c.company_key, -1) AS company_key,
        COALESCE(t.date_key, -1) AS release_date_key,
        
        -- Descriptive attributes
        m.title,
        m.original_title,
        m.overview,
        m.release_year,
        m.release_decade,
        
        -- Measures
        m.budget,
        m.revenue,
        m.profit,
        m.roi_percentage,
        m.runtime,
        m.popularity,
        m.vote_average,
        m.vote_count,
        
        -- Categorizations
        CASE
            WHEN m.budget >= 100000000 THEN 'Blockbuster'
            WHEN m.budget >= 50000000 THEN 'Major'
            WHEN m.budget >= 10000000 THEN 'Medium'
            WHEN m.budget > 0 THEN 'Low Budget'
            ELSE 'Unknown'
        END AS budget_category,
        
        CASE
            WHEN m.vote_average >= 8.0 THEN 'Excellent'
            WHEN m.vote_average >= 7.0 THEN 'Good'
            WHEN m.vote_average >= 6.0 THEN 'Average'
            WHEN m.vote_average >= 5.0 THEN 'Below Average'
            ELSE 'Poor'
        END AS rating_category,
        
        -- Status flags
        CASE WHEN m.profit > 0 THEN TRUE ELSE FALSE END AS is_profitable,
        
        -- Timestamps
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
        
    FROM movies m
    LEFT JOIN primary_genre pg ON m.movie_id = pg.movie_id
    LEFT JOIN genres g ON pg.genre_id = g.genre_id
    LEFT JOIN primary_company pc ON m.movie_id = pc.movie_id
    LEFT JOIN companies c ON pc.company_id = c.company_id
    LEFT JOIN time_dim t ON m.release_date = t.full_date
)

SELECT * FROM final
        );
[0m13:56:13.697014 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:56:13.854936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158c2750>]}
[0m13:56:13.855435 [info ] [Thread-1 (]: 7 of 9 OK created sql table model ANALYTICS_analytics.dim_person ............... [[32mSUCCESS 1[0m in 1.47s]
[0m13:56:13.855846 [debug] [Thread-1 (]: Finished running node model.tmdb_analytics.dim_person
[0m13:56:15.528716 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:56:15.533426 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.fact_movie (execute): 13:56:13.691725 => 13:56:15.533060
[0m13:56:15.534050 [debug] [Thread-2 (]: On model.tmdb_analytics.fact_movie: Close
[0m13:56:15.753286 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102982f30>]}
[0m13:56:15.754506 [info ] [Thread-2 (]: 8 of 9 OK created sql table model ANALYTICS_analytics.fact_movie ............... [[32mSUCCESS 1[0m in 2.07s]
[0m13:56:15.755437 [debug] [Thread-2 (]: Finished running node model.tmdb_analytics.fact_movie
[0m13:56:15.756886 [debug] [Thread-3 (]: Began running node model.tmdb_analytics.fact_credit
[0m13:56:15.757511 [info ] [Thread-3 (]: 9 of 9 START sql table model ANALYTICS_analytics.fact_credit ................... [RUN]
[0m13:56:15.758336 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.dim_genre, now model.tmdb_analytics.fact_credit)
[0m13:56:15.758709 [debug] [Thread-3 (]: Began compiling node model.tmdb_analytics.fact_credit
[0m13:56:15.762836 [debug] [Thread-3 (]: Writing injected SQL for node "model.tmdb_analytics.fact_credit"
[0m13:56:15.763695 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.fact_credit (compile): 13:56:15.758932 => 13:56:15.763499
[0m13:56:15.764005 [debug] [Thread-3 (]: Began executing node model.tmdb_analytics.fact_credit
[0m13:56:15.766371 [debug] [Thread-3 (]: Writing runtime sql for node "model.tmdb_analytics.fact_credit"
[0m13:56:15.767625 [debug] [Thread-3 (]: Using snowflake connection "model.tmdb_analytics.fact_credit"
[0m13:56:15.767925 [debug] [Thread-3 (]: On model.tmdb_analytics.fact_credit: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "model.tmdb_analytics.fact_credit"} */
create or replace transient table TMDB_DW.ANALYTICS_analytics.fact_credit
         as
        (-- Fact table for movie credits
-- Grain: One row per person per movie per role



WITH credits AS (
    SELECT * FROM TMDB_DW.ANALYTICS_staging.stg_credits
),

final AS (
    SELECT
        ROW_NUMBER() OVER (ORDER BY c.credit_id) AS credit_key,
        c.credit_id,
        
        -- Foreign keys
        fm.movie_key,
        dp.person_key,
        
        -- Credit details
        c.credit_type,
        c.character_name,
        c.job_title,
        c.department,
        c.cast_order,
        
        -- Flags
        c.is_director,
        c.is_lead_actor,
        
        -- Metadata
        CURRENT_TIMESTAMP() AS created_at,
        CURRENT_TIMESTAMP() AS updated_at
        
    FROM credits c
    LEFT JOIN TMDB_DW.ANALYTICS_analytics.fact_movie fm ON c.movie_id = fm.movie_id
    LEFT JOIN TMDB_DW.ANALYTICS_analytics.dim_person dp ON c.person_id = dp.person_id
    WHERE fm.movie_key IS NOT NULL
      AND dp.person_key IS NOT NULL
)

SELECT * FROM final
        );
[0m13:56:15.768209 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:56:18.890322 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m13:56:18.894844 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.fact_credit (execute): 13:56:15.764192 => 13:56:18.894563
[0m13:56:18.895450 [debug] [Thread-3 (]: On model.tmdb_analytics.fact_credit: Close
[0m13:56:19.109953 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ddd56ed-5e6c-4e26-a896-c9f626138387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11583d250>]}
[0m13:56:19.111279 [info ] [Thread-3 (]: 9 of 9 OK created sql table model ANALYTICS_analytics.fact_credit .............. [[32mSUCCESS 1[0m in 3.35s]
[0m13:56:19.112244 [debug] [Thread-3 (]: Finished running node model.tmdb_analytics.fact_credit
[0m13:56:19.115541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:19.116103 [debug] [MainThread]: Connection 'model.tmdb_analytics.dim_person' was properly closed.
[0m13:56:19.116435 [debug] [MainThread]: Connection 'model.tmdb_analytics.fact_movie' was properly closed.
[0m13:56:19.116710 [debug] [MainThread]: Connection 'model.tmdb_analytics.fact_credit' was properly closed.
[0m13:56:19.116979 [debug] [MainThread]: Connection 'model.tmdb_analytics.stg_movies' was properly closed.
[0m13:56:19.117340 [info ] [MainThread]: 
[0m13:56:19.117688 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 15.39 seconds (15.39s).
[0m13:56:19.119118 [debug] [MainThread]: Command end result
[0m13:56:19.128169 [info ] [MainThread]: 
[0m13:56:19.128460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:19.128699 [info ] [MainThread]: 
[0m13:56:19.128941 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:56:19.132034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.285524, "process_user_time": 2.575662, "process_kernel_time": 0.416261, "process_mem_max_rss": "227983360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:56:19.132418 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:19.132334 after 16.29 seconds
[0m13:56:19.132670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076af890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b07800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073582f0>]}
[0m13:56:19.132928 [debug] [MainThread]: Flushing usage events
[0m13:56:29.439749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a6ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a91d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a91a60>]}


============================== 13:56:29.441517 | 1e463236-5448-462d-ac2e-1d01a27e80c7 ==============================
[0m13:56:29.441517 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:56:29.441751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt list --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:56:29.716239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e463236-5448-462d-ac2e-1d01a27e80c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11432fbf0>]}
[0m13:56:29.734573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e463236-5448-462d-ac2e-1d01a27e80c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c4d400>]}
[0m13:56:29.734849 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m13:56:29.742079 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:56:29.755951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:29.756114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:29.758744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e463236-5448-462d-ac2e-1d01a27e80c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11504b350>]}
[0m13:56:29.764007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e463236-5448-462d-ac2e-1d01a27e80c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150b7770>]}
[0m13:56:29.764196 [info ] [MainThread]: Found 9 models, 32 tests, 4 sources, 0 exposures, 0 metrics, 460 macros, 0 groups, 0 semantic models
[0m13:56:29.764346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e463236-5448-462d-ac2e-1d01a27e80c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114feb7d0>]}
[0m13:56:29.766303 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.3468923, "process_user_time": 0.950579, "process_kernel_time": 0.11201, "process_mem_max_rss": "181927936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:56:29.766526 [debug] [MainThread]: Command `dbt list` succeeded at 13:56:29.766480 after 0.35 seconds
[0m13:56:29.766671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110968650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c4e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114be70e0>]}
[0m13:56:29.766787 [debug] [MainThread]: Flushing usage events
[0m15:50:26.612651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151aa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151cddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151cdb50>]}


============================== 15:50:26.615180 | 01641b0d-9f42-4a0c-b894-0fa5c05d5e8e ==============================
[0m15:50:26.615180 [info ] [MainThread]: Running with dbt=1.7.18
[0m15:50:26.615436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:50:27.029434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01641b0d-9f42-4a0c-b894-0fa5c05d5e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fa2b10>]}
[0m15:50:27.048233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01641b0d-9f42-4a0c-b894-0fa5c05d5e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8bbc0>]}
[0m15:50:27.048677 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m15:50:27.058432 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m15:50:27.083236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:27.083458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:27.086388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01641b0d-9f42-4a0c-b894-0fa5c05d5e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b55520>]}
[0m15:50:27.088598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01641b0d-9f42-4a0c-b894-0fa5c05d5e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222dc110>]}
[0m15:50:27.088788 [info ] [MainThread]: Found 9 models, 32 tests, 4 sources, 0 exposures, 0 metrics, 460 macros, 0 groups, 0 semantic models
[0m15:50:27.088945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01641b0d-9f42-4a0c-b894-0fa5c05d5e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121099fa0>]}
[0m15:50:27.090069 [info ] [MainThread]: 
[0m15:50:27.090398 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:50:27.090991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW_ANALYTICS_staging'
[0m15:50:27.091349 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW_ANALYTICS_analytics'
[0m15:50:27.097050 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_staging"
[0m15:50:27.097905 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_analytics"
[0m15:50:27.098047 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_staging"} */
show objects in TMDB_DW.ANALYTICS_staging limit 10000
[0m15:50:27.098210 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_analytics"} */
show objects in TMDB_DW.ANALYTICS_analytics limit 10000
[0m15:50:27.098367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:27.098476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:30.671419 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 4.0 seconds
[0m15:50:30.673635 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: Close
[0m15:50:30.689246 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 4.0 seconds
[0m15:50:30.691087 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: Close
[0m15:50:30.913504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01641b0d-9f42-4a0c-b894-0fa5c05d5e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b75f70>]}
[0m15:50:30.914904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:30.915457 [info ] [MainThread]: 
[0m15:50:30.919336 [debug] [Thread-1 (]: Began running node model.tmdb_analytics.dim_company
[0m15:50:30.919784 [debug] [Thread-2 (]: Began running node model.tmdb_analytics.dim_time
[0m15:50:30.920231 [debug] [Thread-3 (]: Began running node model.tmdb_analytics.stg_credits
[0m15:50:30.920625 [debug] [Thread-4 (]: Began running node model.tmdb_analytics.stg_genres
[0m15:50:30.921252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_staging, now model.tmdb_analytics.dim_company)
[0m15:50:30.922289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_analytics, now model.tmdb_analytics.dim_time)
[0m15:50:30.922866 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.tmdb_analytics.stg_credits'
[0m15:50:30.923405 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.tmdb_analytics.stg_genres'
[0m15:50:30.923687 [debug] [Thread-1 (]: Began compiling node model.tmdb_analytics.dim_company
[0m15:50:30.923944 [debug] [Thread-2 (]: Began compiling node model.tmdb_analytics.dim_time
[0m15:50:30.924199 [debug] [Thread-3 (]: Began compiling node model.tmdb_analytics.stg_credits
[0m15:50:30.924439 [debug] [Thread-4 (]: Began compiling node model.tmdb_analytics.stg_genres
[0m15:50:30.931389 [debug] [Thread-1 (]: Writing injected SQL for node "model.tmdb_analytics.dim_company"
[0m15:50:30.933399 [debug] [Thread-2 (]: Writing injected SQL for node "model.tmdb_analytics.dim_time"
[0m15:50:30.935163 [debug] [Thread-3 (]: Writing injected SQL for node "model.tmdb_analytics.stg_credits"
[0m15:50:30.936657 [debug] [Thread-4 (]: Writing injected SQL for node "model.tmdb_analytics.stg_genres"
[0m15:50:30.937654 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_company (compile): 15:50:30.924624 => 15:50:30.937502
[0m15:50:30.937963 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.stg_credits (compile): 15:50:30.933586 => 15:50:30.937843
[0m15:50:30.938160 [debug] [Thread-1 (]: Began executing node model.tmdb_analytics.dim_company
[0m15:50:30.938384 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_time (compile): 15:50:30.931594 => 15:50:30.938277
[0m15:50:30.938616 [debug] [Thread-3 (]: Began executing node model.tmdb_analytics.stg_credits
[0m15:50:30.938920 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_genres (compile): 15:50:30.935315 => 15:50:30.938761
[0m15:50:30.939207 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.dim_company (execute): 15:50:30.939081 => 15:50:30.939093
[0m15:50:30.939410 [debug] [Thread-2 (]: Began executing node model.tmdb_analytics.dim_time
[0m15:50:30.939698 [debug] [Thread-3 (]: Timing info for model.tmdb_analytics.stg_credits (execute): 15:50:30.939568 => 15:50:30.939575
[0m15:50:30.939914 [debug] [Thread-4 (]: Began executing node model.tmdb_analytics.stg_genres
[0m15:50:30.940534 [debug] [Thread-1 (]: Finished running node model.tmdb_analytics.dim_company
[0m15:50:30.940783 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_time (execute): 15:50:30.940676 => 15:50:30.940680
[0m15:50:30.941247 [debug] [Thread-3 (]: Finished running node model.tmdb_analytics.stg_credits
[0m15:50:30.941478 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.stg_genres (execute): 15:50:30.941373 => 15:50:30.941376
[0m15:50:30.941708 [debug] [Thread-1 (]: Began running node model.tmdb_analytics.stg_movies
[0m15:50:30.942237 [debug] [Thread-2 (]: Finished running node model.tmdb_analytics.dim_time
[0m15:50:30.942532 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m15:50:30.943018 [debug] [Thread-4 (]: Finished running node model.tmdb_analytics.stg_genres
[0m15:50:30.943449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.dim_company, now model.tmdb_analytics.stg_movies)
[0m15:50:30.943676 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m15:50:30.944097 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.stg_credits, now test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78)
[0m15:50:30.944319 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m15:50:30.944541 [debug] [Thread-1 (]: Began compiling node model.tmdb_analytics.stg_movies
[0m15:50:30.944896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.dim_time, now test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb)
[0m15:50:30.945086 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m15:50:30.945417 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.stg_genres, now test.tmdb_analytics.unique_dim_company_company_id.83514dc60d)
[0m15:50:30.946973 [debug] [Thread-1 (]: Writing injected SQL for node "model.tmdb_analytics.stg_movies"
[0m15:50:30.947180 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m15:50:30.953461 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78"
[0m15:50:30.953718 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m15:50:30.956112 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb"
[0m15:50:30.956457 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.stg_movies (compile): 15:50:30.945538 => 15:50:30.956344
[0m15:50:30.959788 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_company_company_id.83514dc60d"
[0m15:50:30.960049 [debug] [Thread-1 (]: Began executing node model.tmdb_analytics.stg_movies
[0m15:50:30.960406 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb (compile): 15:50:30.953899 => 15:50:30.960284
[0m15:50:30.960614 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78 (compile): 15:50:30.947302 => 15:50:30.960518
[0m15:50:30.960872 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.stg_movies (execute): 15:50:30.960729 => 15:50:30.960736
[0m15:50:30.961078 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m15:50:30.961263 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_id.83514dc60d (compile): 15:50:30.956565 => 15:50:30.961171
[0m15:50:30.961427 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m15:50:30.961900 [debug] [Thread-1 (]: Finished running node model.tmdb_analytics.stg_movies
[0m15:50:30.962123 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb (execute): 15:50:30.962023 => 15:50:30.962028
[0m15:50:30.962284 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m15:50:30.962484 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78 (execute): 15:50:30.962388 => 15:50:30.962392
[0m15:50:30.962675 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m15:50:30.963163 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m15:50:30.963364 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_id.83514dc60d (execute): 15:50:30.963276 => 15:50:30.963280
[0m15:50:30.963771 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m15:50:30.964087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.stg_movies, now test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0)
[0m15:50:30.964290 [debug] [Thread-2 (]: Began running node model.tmdb_analytics.dim_person
[0m15:50:30.964919 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m15:50:30.965163 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m15:50:30.965367 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m15:50:30.965697 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb, now model.tmdb_analytics.dim_person)
[0m15:50:30.965891 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m15:50:30.966202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78, now test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812)
[0m15:50:30.968344 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0"
[0m15:50:30.968529 [debug] [Thread-2 (]: Began compiling node model.tmdb_analytics.dim_person
[0m15:50:30.968817 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_company_company_id.83514dc60d, now test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea)
[0m15:50:30.968982 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m15:50:30.970510 [debug] [Thread-2 (]: Writing injected SQL for node "model.tmdb_analytics.dim_person"
[0m15:50:30.970682 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m15:50:30.972522 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812"
[0m15:50:30.972772 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0 (compile): 15:50:30.966323 => 15:50:30.972681
[0m15:50:30.975501 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea"
[0m15:50:30.975774 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_person (compile): 15:50:30.969124 => 15:50:30.975676
[0m15:50:30.975918 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m15:50:30.976163 [debug] [Thread-2 (]: Began executing node model.tmdb_analytics.dim_person
[0m15:50:30.976338 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812 (compile): 15:50:30.970803 => 15:50:30.976246
[0m15:50:30.976527 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0 (execute): 15:50:30.976446 => 15:50:30.976450
[0m15:50:30.976727 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_person (execute): 15:50:30.976646 => 15:50:30.976649
[0m15:50:30.976903 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea (compile): 15:50:30.972864 => 15:50:30.976819
[0m15:50:30.977032 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m15:50:30.977395 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m15:50:30.977733 [debug] [Thread-2 (]: Finished running node model.tmdb_analytics.dim_person
[0m15:50:30.977874 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m15:50:30.978048 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812 (execute): 15:50:30.977965 => 15:50:30.977968
[0m15:50:30.978213 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m15:50:30.978397 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m15:50:30.978595 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea (execute): 15:50:30.978514 => 15:50:30.978517
[0m15:50:30.978970 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m15:50:30.979215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0, now test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2)
[0m15:50:30.979480 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.dim_person, now test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1)
[0m15:50:30.979810 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m15:50:30.979973 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m15:50:30.980129 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m15:50:30.980265 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m15:50:30.980433 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m15:50:30.980710 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812, now test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec)
[0m15:50:30.982473 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2"
[0m15:50:30.984040 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1"
[0m15:50:30.984301 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea, now test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c)
[0m15:50:30.984454 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m15:50:30.984655 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m15:50:30.986352 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec"
[0m15:50:30.987944 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c"
[0m15:50:30.988149 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2 (compile): 15:50:30.980808 => 15:50:30.988068
[0m15:50:30.988308 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1 (compile): 15:50:30.982590 => 15:50:30.988228
[0m15:50:30.988493 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m15:50:30.988677 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m15:50:30.988841 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec (compile): 15:50:30.984800 => 15:50:30.988768
[0m15:50:30.989024 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2 (execute): 15:50:30.988936 => 15:50:30.988940
[0m15:50:30.989194 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c (compile): 15:50:30.986483 => 15:50:30.989114
[0m15:50:30.989369 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1 (execute): 15:50:30.989291 => 15:50:30.989294
[0m15:50:30.989510 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m15:50:30.989867 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m15:50:30.990010 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m15:50:30.990331 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m15:50:30.990493 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec (execute): 15:50:30.990419 => 15:50:30.990422
[0m15:50:30.990650 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m15:50:30.990843 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c (execute): 15:50:30.990767 => 15:50:30.990770
[0m15:50:30.990992 [debug] [Thread-2 (]: Began running node model.tmdb_analytics.dim_genre
[0m15:50:30.991327 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m15:50:30.991572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2, now test.tmdb_analytics.unique_dim_time_date_key.c815c3216d)
[0m15:50:30.991917 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m15:50:30.992163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1, now model.tmdb_analytics.dim_genre)
[0m15:50:30.992325 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m15:50:30.992476 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m15:50:30.992637 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m15:50:30.992788 [debug] [Thread-2 (]: Began compiling node model.tmdb_analytics.dim_genre
[0m15:50:30.993022 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec, now test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e)
[0m15:50:30.994593 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_time_date_key.c815c3216d"
[0m15:50:30.994837 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c, now test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246)
[0m15:50:30.996045 [debug] [Thread-2 (]: Writing injected SQL for node "model.tmdb_analytics.dim_genre"
[0m15:50:30.996184 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m15:50:30.996338 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m15:50:30.996536 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_dim_time_date_key.c815c3216d (compile): 15:50:30.993112 => 15:50:30.996456
[0m15:50:30.998134 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e"
[0m15:50:30.999774 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246"
[0m15:50:30.999946 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_genre (compile): 15:50:30.994930 => 15:50:30.999864
[0m15:50:31.000085 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m15:50:31.000283 [debug] [Thread-2 (]: Began executing node model.tmdb_analytics.dim_genre
[0m15:50:31.000485 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_dim_time_date_key.c815c3216d (execute): 15:50:31.000400 => 15:50:31.000403
[0m15:50:31.000680 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246 (compile): 15:50:30.998266 => 15:50:31.000596
[0m15:50:31.000842 [debug] [Thread-2 (]: Timing info for model.tmdb_analytics.dim_genre (execute): 15:50:31.000766 => 15:50:31.000768
[0m15:50:31.001018 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e (compile): 15:50:30.996628 => 15:50:31.000943
[0m15:50:31.001339 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m15:50:31.001475 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m15:50:31.001825 [debug] [Thread-2 (]: Finished running node model.tmdb_analytics.dim_genre
[0m15:50:31.001966 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m15:50:31.002128 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m15:50:31.002314 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246 (execute): 15:50:31.002237 => 15:50:31.002239
[0m15:50:31.002464 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m15:50:31.002661 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e (execute): 15:50:31.002579 => 15:50:31.002581
[0m15:50:31.002963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_time_date_key.c815c3216d, now test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a)
[0m15:50:31.003312 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m15:50:31.003556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.dim_genre, now test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78)
[0m15:50:31.003901 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m15:50:31.004037 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m15:50:31.004191 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m15:50:31.004342 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m15:50:31.004489 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m15:50:31.006092 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a"
[0m15:50:31.006343 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246, now test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94)
[0m15:50:31.007891 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78"
[0m15:50:31.008143 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e, now test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692)
[0m15:50:31.008322 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m15:50:31.008507 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m15:50:31.008681 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a (compile): 15:50:31.004587 => 15:50:31.008607
[0m15:50:31.008851 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78 (compile): 15:50:31.006448 => 15:50:31.008774
[0m15:50:31.011049 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94"
[0m15:50:31.049093 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692"
[0m15:50:31.049289 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m15:50:31.049427 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m15:50:31.049755 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a (execute): 15:50:31.049635 => 15:50:31.049643
[0m15:50:31.049987 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78 (execute): 15:50:31.049905 => 15:50:31.049909
[0m15:50:31.050358 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m15:50:31.050497 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94 (compile): 15:50:31.008930 => 15:50:31.050427
[0m15:50:31.050630 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692 (compile): 15:50:31.011149 => 15:50:31.050563
[0m15:50:31.050927 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m15:50:31.051074 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m15:50:31.051223 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m15:50:31.051344 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m15:50:31.051491 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m15:50:31.051720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a, now test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d)
[0m15:50:31.051875 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94 (execute): 15:50:31.051808 => 15:50:31.051810
[0m15:50:31.052015 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692 (execute): 15:50:31.051952 => 15:50:31.051954
[0m15:50:31.052219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78, now test.tmdb_analytics.unique_dim_person_person_key.5658ff842e)
[0m15:50:31.052338 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m15:50:31.052618 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m15:50:31.052892 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m15:50:31.053020 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m15:50:31.054593 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d"
[0m15:50:31.054740 [debug] [Thread-4 (]: Began running node model.tmdb_analytics.fact_movie
[0m15:50:31.054906 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m15:50:31.056462 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_person_person_key.5658ff842e"
[0m15:50:31.056746 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94, now model.tmdb_analytics.fact_movie)
[0m15:50:31.057028 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692, now test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c)
[0m15:50:31.057204 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d (compile): 15:50:31.053103 => 15:50:31.057126
[0m15:50:31.057362 [debug] [Thread-4 (]: Began compiling node model.tmdb_analytics.fact_movie
[0m15:50:31.057506 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m15:50:31.057644 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m15:50:31.057810 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_key.5658ff842e (compile): 15:50:31.055011 => 15:50:31.057731
[0m15:50:31.059145 [debug] [Thread-4 (]: Writing injected SQL for node "model.tmdb_analytics.fact_movie"
[0m15:50:31.060532 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c"
[0m15:50:31.060709 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d (execute): 15:50:31.060623 => 15:50:31.060627
[0m15:50:31.060842 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m15:50:31.061236 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m15:50:31.061410 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_key.5658ff842e (execute): 15:50:31.061329 => 15:50:31.061332
[0m15:50:31.061586 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m15:50:31.061759 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.fact_movie (compile): 15:50:31.057887 => 15:50:31.061679
[0m15:50:31.061956 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c (compile): 15:50:31.059232 => 15:50:31.061880
[0m15:50:31.062356 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m15:50:31.062640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d, now test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a)
[0m15:50:31.062803 [debug] [Thread-4 (]: Began executing node model.tmdb_analytics.fact_movie
[0m15:50:31.062964 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m15:50:31.063143 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m15:50:31.063300 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m15:50:31.063576 [debug] [Thread-4 (]: Timing info for model.tmdb_analytics.fact_movie (execute): 15:50:31.063436 => 15:50:31.063442
[0m15:50:31.063783 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c (execute): 15:50:31.063697 => 15:50:31.063700
[0m15:50:31.064047 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_person_person_key.5658ff842e, now test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3)
[0m15:50:31.065889 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a"
[0m15:50:31.066261 [debug] [Thread-4 (]: Finished running node model.tmdb_analytics.fact_movie
[0m15:50:31.066632 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m15:50:31.066784 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m15:50:31.066984 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m15:50:31.067241 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m15:50:31.068971 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3"
[0m15:50:31.069114 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a (compile): 15:50:31.064146 => 15:50:31.069044
[0m15:50:31.069355 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.fact_movie, now test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc)
[0m15:50:31.069602 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c, now test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d)
[0m15:50:31.069782 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m15:50:31.069969 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m15:50:31.070124 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m15:50:31.070280 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3 (compile): 15:50:31.067368 => 15:50:31.070199
[0m15:50:31.070452 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a (execute): 15:50:31.070369 => 15:50:31.070372
[0m15:50:31.072202 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc"
[0m15:50:31.073711 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d"
[0m15:50:31.073880 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m15:50:31.074219 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m15:50:31.074442 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3 (execute): 15:50:31.074368 => 15:50:31.074370
[0m15:50:31.074636 [debug] [Thread-1 (]: Began running node model.tmdb_analytics.fact_credit
[0m15:50:31.074833 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d (compile): 15:50:31.072308 => 15:50:31.074752
[0m15:50:31.075153 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m15:50:31.075312 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc (compile): 15:50:31.070551 => 15:50:31.075233
[0m15:50:31.075576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a, now model.tmdb_analytics.fact_credit)
[0m15:50:31.075732 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m15:50:31.075889 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m15:50:31.076042 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m15:50:31.076183 [debug] [Thread-1 (]: Began compiling node model.tmdb_analytics.fact_credit
[0m15:50:31.076353 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d (execute): 15:50:31.076278 => 15:50:31.076281
[0m15:50:31.076592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3, now test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6)
[0m15:50:31.076768 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc (execute): 15:50:31.076690 => 15:50:31.076693
[0m15:50:31.078071 [debug] [Thread-1 (]: Writing injected SQL for node "model.tmdb_analytics.fact_credit"
[0m15:50:31.078423 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m15:50:31.078575 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m15:50:31.078911 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m15:50:31.079106 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m15:50:31.080581 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6"
[0m15:50:31.080765 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m15:50:31.080936 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.fact_credit (compile): 15:50:31.076867 => 15:50:31.080858
[0m15:50:31.081186 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d, now test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae)
[0m15:50:31.081479 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc, now test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645)
[0m15:50:31.081639 [debug] [Thread-1 (]: Began executing node model.tmdb_analytics.fact_credit
[0m15:50:31.081789 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m15:50:31.081954 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6 (compile): 15:50:31.079213 => 15:50:31.081878
[0m15:50:31.082081 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m15:50:31.082248 [debug] [Thread-1 (]: Timing info for model.tmdb_analytics.fact_credit (execute): 15:50:31.082173 => 15:50:31.082176
[0m15:50:31.084650 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae"
[0m15:50:31.084803 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m15:50:31.086256 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645"
[0m15:50:31.086595 [debug] [Thread-1 (]: Finished running node model.tmdb_analytics.fact_credit
[0m15:50:31.086810 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6 (execute): 15:50:31.086730 => 15:50:31.086732
[0m15:50:31.087034 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m15:50:31.087204 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae (compile): 15:50:31.082332 => 15:50:31.087117
[0m15:50:31.087622 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m15:50:31.087784 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645 (compile): 15:50:31.084894 => 15:50:31.087703
[0m15:50:31.088033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tmdb_analytics.fact_credit, now test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da)
[0m15:50:31.088182 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m15:50:31.088340 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m15:50:31.088493 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m15:50:31.088636 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m15:50:31.088801 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae (execute): 15:50:31.088723 => 15:50:31.088726
[0m15:50:31.089036 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6, now test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f)
[0m15:50:31.089205 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645 (execute): 15:50:31.089127 => 15:50:31.089131
[0m15:50:31.090671 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da"
[0m15:50:31.091016 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m15:50:31.091158 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m15:50:31.091495 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m15:50:31.091686 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m15:50:31.093232 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f"
[0m15:50:31.093418 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da (compile): 15:50:31.089295 => 15:50:31.093337
[0m15:50:31.093565 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m15:50:31.093818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae, now test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c)
[0m15:50:31.094005 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m15:50:31.094271 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645, now test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4)
[0m15:50:31.094420 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m15:50:31.094590 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f (compile): 15:50:31.091808 => 15:50:31.094509
[0m15:50:31.094746 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da (execute): 15:50:31.094670 => 15:50:31.094673
[0m15:50:31.094878 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m15:50:31.096502 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c"
[0m15:50:31.096653 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m15:50:31.097001 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m15:50:31.098601 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4"
[0m15:50:31.098834 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f (execute): 15:50:31.098745 => 15:50:31.098749
[0m15:50:31.099013 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m15:50:31.099209 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c (compile): 15:50:31.094970 => 15:50:31.099127
[0m15:50:31.099585 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m15:50:31.099848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da, now test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee)
[0m15:50:31.100041 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4 (compile): 15:50:31.097096 => 15:50:31.099960
[0m15:50:31.100180 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m15:50:31.100368 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m15:50:31.100515 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m15:50:31.100690 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c (execute): 15:50:31.100608 => 15:50:31.100611
[0m15:50:31.102135 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee"
[0m15:50:31.102329 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4 (execute): 15:50:31.102242 => 15:50:31.102245
[0m15:50:31.102652 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m15:50:31.103014 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m15:50:31.103263 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee (compile): 15:50:31.100786 => 15:50:31.103185
[0m15:50:31.103394 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m15:50:31.103552 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee (execute): 15:50:31.103478 => 15:50:31.103480
[0m15:50:31.103828 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m15:50:31.104294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:31.104424 [debug] [MainThread]: Connection 'test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee' was properly closed.
[0m15:50:31.104532 [debug] [MainThread]: Connection 'test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f' was properly closed.
[0m15:50:31.104627 [debug] [MainThread]: Connection 'test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c' was properly closed.
[0m15:50:31.104714 [debug] [MainThread]: Connection 'test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4' was properly closed.
[0m15:50:31.106368 [debug] [MainThread]: Command end result
[0m15:50:31.112144 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m15:50:31.112264 [info ] [MainThread]: Building catalog
[0m15:50:31.113582 [debug] [ThreadPool]: Acquiring new snowflake connection 'TMDB_DW.information_schema'
[0m15:50:31.121301 [debug] [ThreadPool]: Using snowflake connection "TMDB_DW.information_schema"
[0m15:50:31.121610 [debug] [ThreadPool]: On TMDB_DW.information_schema: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "TMDB_DW.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from TMDB_DW.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'fact_movie' and upper("table_name") = upper('fact_movie')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_movies' and upper("table_name") = upper('raw_movies')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_staging' and upper("table_schema") = upper('ANALYTICS_staging')

                    and 
    "table_name" ilike 'stg_credits' and upper("table_name") = upper('stg_credits')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_staging' and upper("table_schema") = upper('ANALYTICS_staging')

                    and 
    "table_name" ilike 'stg_movies' and upper("table_name") = upper('stg_movies')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'dim_genre' and upper("table_name") = upper('dim_genre')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_companies' and upper("table_name") = upper('raw_companies')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'dim_time' and upper("table_name") = upper('dim_time')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'dim_person' and upper("table_name") = upper('dim_person')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_credits' and upper("table_name") = upper('raw_credits')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_staging' and upper("table_schema") = upper('ANALYTICS_staging')

                    and 
    "table_name" ilike 'stg_genres' and upper("table_name") = upper('stg_genres')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'fact_credit' and upper("table_name") = upper('fact_credit')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'dim_company' and upper("table_name") = upper('dim_company')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_genres' and upper("table_name") = upper('raw_genres')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from TMDB_DW.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'fact_movie' and upper("table_name") = upper('fact_movie')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_movies' and upper("table_name") = upper('raw_movies')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_staging' and upper("table_schema") = upper('ANALYTICS_staging')

                    and 
    "table_name" ilike 'stg_credits' and upper("table_name") = upper('stg_credits')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_staging' and upper("table_schema") = upper('ANALYTICS_staging')

                    and 
    "table_name" ilike 'stg_movies' and upper("table_name") = upper('stg_movies')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'dim_genre' and upper("table_name") = upper('dim_genre')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_companies' and upper("table_name") = upper('raw_companies')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'dim_time' and upper("table_name") = upper('dim_time')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'dim_person' and upper("table_name") = upper('dim_person')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_credits' and upper("table_name") = upper('raw_credits')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_staging' and upper("table_schema") = upper('ANALYTICS_staging')

                    and 
    "table_name" ilike 'stg_genres' and upper("table_name") = upper('stg_genres')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'fact_credit' and upper("table_name") = upper('fact_credit')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS_analytics' and upper("table_schema") = upper('ANALYTICS_analytics')

                    and 
    "table_name" ilike 'dim_company' and upper("table_name") = upper('dim_company')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_genres' and upper("table_name") = upper('raw_genres')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m15:50:31.121876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:41.258671 [debug] [ThreadPool]: SQL status: SUCCESS 140 in 10.0 seconds
[0m15:50:41.279640 [debug] [ThreadPool]: On TMDB_DW.information_schema: Close
[0m15:50:41.521086 [info ] [MainThread]: Catalog written to /Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/target/catalog.json
[0m15:50:41.523981 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 14.935985, "process_user_time": 1.578836, "process_kernel_time": 0.347039, "process_mem_max_rss": "217776128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:50:41.524461 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:50:41.524365 after 14.94 seconds
[0m15:50:41.524661 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:50:41.524813 [debug] [MainThread]: Connection 'TMDB_DW.information_schema' was properly closed.
[0m15:50:41.524998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221d3b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e58140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12261b050>]}
[0m15:50:41.525213 [debug] [MainThread]: Flushing usage events
[0m15:51:47.268452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107463b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071769c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107463170>]}


============================== 15:51:47.271030 | 284cebb8-2cba-49b1-b913-654f3325dcd2 ==============================
[0m15:51:47.271030 [info ] [MainThread]: Running with dbt=1.7.18
[0m15:51:47.271295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:47.645758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '284cebb8-2cba-49b1-b913-654f3325dcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106347ad0>]}
[0m15:51:47.664656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '284cebb8-2cba-49b1-b913-654f3325dcd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105813920>]}
[0m15:51:47.762358 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m15:51:47.765082 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/dipinjassal/ml/tmdb_data_warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dipinjassal/ml/tmdb_data_warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dipinjassal/ml/tmdb_data_warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dipinjassal/ml/tmdb_data_warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dipinjassal/ml/tmdb_data_warehouse/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/dipinjassal/ml/tmdb_data_warehouse/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 325, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/dipinjassal/ml/tmdb_data_warehouse/venv/lib/python3.12/site-packages/dbt/task/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m15:51:47.767771 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.5212808, "process_user_time": 0.985864, "process_kernel_time": 0.130016, "process_mem_max_rss": "177373184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:51:47.768317 [debug] [MainThread]: Command `dbt docs serve` failed at 15:51:47.768183 after 0.52 seconds
[0m15:51:47.769033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107485c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3fed50>]}
[0m15:51:47.769357 [debug] [MainThread]: Flushing usage events
[0m16:00:55.088340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054593d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a99d0>]}


============================== 16:00:55.090664 | b311d58a-58a3-43e3-8187-bf9421228177 ==============================
[0m16:00:55.090664 [info ] [MainThread]: Running with dbt=1.7.18
[0m16:00:55.090904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:00:55.453751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b311d58a-58a3-43e3-8187-bf9421228177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109331ca0>]}
[0m16:00:55.471975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b311d58a-58a3-43e3-8187-bf9421228177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952ecf0>]}
[0m16:00:55.472402 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m16:00:55.481302 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m16:00:55.504318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:55.504492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:55.507189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b311d58a-58a3-43e3-8187-bf9421228177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093a4470>]}
[0m16:00:55.513304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b311d58a-58a3-43e3-8187-bf9421228177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10958ba40>]}
[0m16:00:55.513491 [info ] [MainThread]: Found 9 models, 32 tests, 4 sources, 0 exposures, 0 metrics, 460 macros, 0 groups, 0 semantic models
[0m16:00:55.513645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b311d58a-58a3-43e3-8187-bf9421228177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092269c0>]}
[0m16:00:55.514898 [info ] [MainThread]: 
[0m16:00:55.515225 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:00:55.515819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW_ANALYTICS_analytics'
[0m16:00:55.516157 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW_ANALYTICS_staging'
[0m16:00:55.521743 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_analytics"
[0m16:00:55.522647 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_staging"
[0m16:00:55.522775 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_analytics"} */
show objects in TMDB_DW.ANALYTICS_analytics limit 10000
[0m16:00:55.522908 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_staging"} */
show objects in TMDB_DW.ANALYTICS_staging limit 10000
[0m16:00:55.523033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:55.523140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:59.141939 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 4.0 seconds
[0m16:00:59.146528 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: Close
[0m16:00:59.183067 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 4.0 seconds
[0m16:00:59.185629 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: Close
[0m16:00:59.389827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b311d58a-58a3-43e3-8187-bf9421228177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c66c30>]}
[0m16:00:59.391107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:59.391505 [info ] [MainThread]: 
[0m16:00:59.396237 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m16:00:59.396635 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m16:00:59.397026 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m16:00:59.397429 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m16:00:59.397891 [info ] [Thread-1 (]: 1 of 32 START test not_null_dim_company_company_id ............................. [RUN]
[0m16:00:59.398287 [info ] [Thread-2 (]: 2 of 32 START test not_null_dim_company_company_key ............................ [RUN]
[0m16:00:59.398625 [info ] [Thread-3 (]: 3 of 32 START test not_null_dim_genre_genre_id ................................. [RUN]
[0m16:00:59.398936 [info ] [Thread-4 (]: 4 of 32 START test not_null_dim_genre_genre_key ................................ [RUN]
[0m16:00:59.399498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_analytics, now test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78)
[0m16:00:59.399985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_staging, now test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb)
[0m16:00:59.400527 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c'
[0m16:00:59.401021 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a'
[0m16:00:59.401284 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m16:00:59.401537 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m16:00:59.401783 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m16:00:59.402022 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m16:00:59.413887 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78"
[0m16:00:59.416380 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb"
[0m16:00:59.418672 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c"
[0m16:00:59.420734 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a"
[0m16:00:59.421513 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb (compile): 16:00:59.414039 => 16:00:59.421368
[0m16:00:59.421751 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78 (compile): 16:00:59.402201 => 16:00:59.421641
[0m16:00:59.422018 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c (compile): 16:00:59.416554 => 16:00:59.421879
[0m16:00:59.422244 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a (compile): 16:00:59.418811 => 16:00:59.422137
[0m16:00:59.422434 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m16:00:59.422631 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m16:00:59.422809 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m16:00:59.422985 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m16:00:59.434083 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb"
[0m16:00:59.435565 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78"
[0m16:00:59.437647 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c"
[0m16:00:59.438873 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a"
[0m16:00:59.439693 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78"
[0m16:00:59.439890 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_id
from TMDB_DW.ANALYTICS_analytics.dim_company
where company_id is null



      
    ) dbt_internal_test
[0m16:00:59.440222 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a"
[0m16:00:59.440575 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb"
[0m16:00:59.440735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:59.441014 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c"
[0m16:00:59.441185 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genre_key
from TMDB_DW.ANALYTICS_analytics.dim_genre
where genre_key is null



      
    ) dbt_internal_test
[0m16:00:59.441371 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_key
from TMDB_DW.ANALYTICS_analytics.dim_company
where company_key is null



      
    ) dbt_internal_test
[0m16:00:59.441602 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genre_id
from TMDB_DW.ANALYTICS_analytics.dim_genre
where genre_id is null



      
    ) dbt_internal_test
[0m16:00:59.441992 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:00:59.442265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:00:59.442831 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:01:02.610447 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:01:02.619259 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb (execute): 16:00:59.423100 => 16:01:02.618741
[0m16:01:02.619958 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb: Close
[0m16:01:02.910040 [info ] [Thread-2 (]: 2 of 32 PASS not_null_dim_company_company_key .................................. [[32mPASS[0m in 3.51s]
[0m16:01:02.911656 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m16:01:02.912250 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m16:01:02.912861 [info ] [Thread-2 (]: 5 of 32 START test not_null_dim_genre_genre_name ............................... [RUN]
[0m16:01:02.913778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb, now test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3)
[0m16:01:02.914211 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m16:01:02.918935 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3"
[0m16:01:02.919770 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3 (compile): 16:01:02.914453 => 16:01:02.919566
[0m16:01:02.920095 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m16:01:02.922186 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3"
[0m16:01:02.922957 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3"
[0m16:01:02.923228 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genre_name
from TMDB_DW.ANALYTICS_analytics.dim_genre
where genre_name is null



      
    ) dbt_internal_test
[0m16:01:02.923487 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:02.947674 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:01:02.949049 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c (execute): 16:00:59.435718 => 16:01:02.948898
[0m16:01:02.949315 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c: Close
[0m16:01:02.950795 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:01:02.952108 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a (execute): 16:00:59.437789 => 16:01:02.951942
[0m16:01:02.952336 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a: Close
[0m16:01:03.111729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:01:03.112805 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78 (execute): 16:00:59.434332 => 16:01:03.112676
[0m16:01:03.113016 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78: Close
[0m16:01:03.157952 [info ] [Thread-3 (]: 3 of 32 PASS not_null_dim_genre_genre_id ....................................... [[32mPASS[0m in 3.76s]
[0m16:01:03.158382 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m16:01:03.158666 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m16:01:03.158971 [info ] [Thread-3 (]: 6 of 32 START test not_null_dim_person_person_id ............................... [RUN]
[0m16:01:03.159463 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c, now test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94)
[0m16:01:03.159703 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m16:01:03.163008 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94"
[0m16:01:03.163524 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94 (compile): 16:01:03.159846 => 16:01:03.163394
[0m16:01:03.163746 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m16:01:03.165350 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94"
[0m16:01:03.165938 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94"
[0m16:01:03.166178 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select person_id
from TMDB_DW.ANALYTICS_analytics.dim_person
where person_id is null



      
    ) dbt_internal_test
[0m16:01:03.166402 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:03.221856 [info ] [Thread-4 (]: 4 of 32 PASS not_null_dim_genre_genre_key ...................................... [[32mPASS[0m in 3.82s]
[0m16:01:03.222326 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m16:01:03.222594 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m16:01:03.222864 [info ] [Thread-4 (]: 7 of 32 START test not_null_dim_person_person_key .............................. [RUN]
[0m16:01:03.223319 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a, now test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692)
[0m16:01:03.223532 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m16:01:03.227086 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692"
[0m16:01:03.227532 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692 (compile): 16:01:03.223663 => 16:01:03.227412
[0m16:01:03.227731 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m16:01:03.229186 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692"
[0m16:01:03.229689 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692"
[0m16:01:03.229884 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select person_key
from TMDB_DW.ANALYTICS_analytics.dim_person
where person_key is null



      
    ) dbt_internal_test
[0m16:01:03.230074 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:03.318896 [info ] [Thread-1 (]: 1 of 32 PASS not_null_dim_company_company_id ................................... [[32mPASS[0m in 3.92s]
[0m16:01:03.319314 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m16:01:03.319559 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m16:01:03.319765 [info ] [Thread-1 (]: 8 of 32 START test not_null_dim_time_date_key .................................. [RUN]
[0m16:01:03.320203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78, now test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec)
[0m16:01:03.320434 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m16:01:03.323057 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec"
[0m16:01:03.323456 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec (compile): 16:01:03.320566 => 16:01:03.323344
[0m16:01:03.323644 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m16:01:03.325011 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec"
[0m16:01:03.325476 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec"
[0m16:01:03.325658 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from TMDB_DW.ANALYTICS_analytics.dim_time
where date_key is null



      
    ) dbt_internal_test
[0m16:01:03.325829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:03.531477 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:03.533180 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3 (execute): 16:01:02.920284 => 16:01:03.532980
[0m16:01:03.533478 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3: Close
[0m16:01:03.759871 [info ] [Thread-2 (]: 5 of 32 PASS not_null_dim_genre_genre_name ..................................... [[32mPASS[0m in 0.85s]
[0m16:01:03.761150 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m16:01:03.761792 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m16:01:03.762489 [info ] [Thread-2 (]: 9 of 32 START test not_null_dim_time_full_date ................................. [RUN]
[0m16:01:03.763720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3, now test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c)
[0m16:01:03.764268 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m16:01:03.769412 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c"
[0m16:01:03.770279 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c (compile): 16:01:03.764536 => 16:01:03.770081
[0m16:01:03.770594 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m16:01:03.772955 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c"
[0m16:01:03.773727 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c"
[0m16:01:03.773999 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select full_date
from TMDB_DW.ANALYTICS_analytics.dim_time
where full_date is null



      
    ) dbt_internal_test
[0m16:01:03.774256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:03.793738 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:03.795229 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94 (execute): 16:01:03.163876 => 16:01:03.795081
[0m16:01:03.795501 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94: Close
[0m16:01:03.803924 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:03.805134 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692 (execute): 16:01:03.227844 => 16:01:03.804994
[0m16:01:03.805358 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692: Close
[0m16:01:03.990156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:03.992058 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec (execute): 16:01:03.323755 => 16:01:03.991834
[0m16:01:03.992409 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec: Close
[0m16:01:03.995616 [info ] [Thread-3 (]: 6 of 32 PASS not_null_dim_person_person_id ..................................... [[32mPASS[0m in 0.84s]
[0m16:01:03.996446 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m16:01:03.996855 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m16:01:03.997397 [info ] [Thread-3 (]: 10 of 32 START test not_null_fact_credit_credit_key ............................ [RUN]
[0m16:01:03.998114 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94, now test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f)
[0m16:01:03.998437 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m16:01:04.002238 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f"
[0m16:01:04.002826 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f (compile): 16:01:03.998628 => 16:01:04.002656
[0m16:01:04.003095 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m16:01:04.005054 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f"
[0m16:01:04.005682 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f"
[0m16:01:04.005919 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select credit_key
from TMDB_DW.ANALYTICS_analytics.fact_credit
where credit_key is null



      
    ) dbt_internal_test
[0m16:01:04.006143 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:04.029143 [info ] [Thread-4 (]: 7 of 32 PASS not_null_dim_person_person_key .................................... [[32mPASS[0m in 0.81s]
[0m16:01:04.029501 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m16:01:04.029731 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m16:01:04.029981 [info ] [Thread-4 (]: 11 of 32 START test not_null_fact_credit_movie_key ............................. [RUN]
[0m16:01:04.030403 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692, now test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c)
[0m16:01:04.030606 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m16:01:04.033260 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c"
[0m16:01:04.033716 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c (compile): 16:01:04.030727 => 16:01:04.033595
[0m16:01:04.033907 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m16:01:04.035319 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c"
[0m16:01:04.035812 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c"
[0m16:01:04.035995 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_key
from TMDB_DW.ANALYTICS_analytics.fact_credit
where movie_key is null



      
    ) dbt_internal_test
[0m16:01:04.036196 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:04.199919 [info ] [Thread-1 (]: 8 of 32 PASS not_null_dim_time_date_key ........................................ [[32mPASS[0m in 0.88s]
[0m16:01:04.200314 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m16:01:04.200546 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m16:01:04.200806 [info ] [Thread-1 (]: 12 of 32 START test not_null_fact_credit_person_key ............................ [RUN]
[0m16:01:04.201221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec, now test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4)
[0m16:01:04.201418 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m16:01:04.204098 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4"
[0m16:01:04.204531 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4 (compile): 16:01:04.201540 => 16:01:04.204415
[0m16:01:04.204714 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m16:01:04.206193 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4"
[0m16:01:04.206704 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4"
[0m16:01:04.206904 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select person_key
from TMDB_DW.ANALYTICS_analytics.fact_credit
where person_key is null



      
    ) dbt_internal_test
[0m16:01:04.207085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:04.382666 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:04.384168 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c (execute): 16:01:03.770799 => 16:01:04.383997
[0m16:01:04.384436 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c: Close
[0m16:01:04.574857 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:04.577111 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f (execute): 16:01:04.003260 => 16:01:04.576874
[0m16:01:04.577495 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f: Close
[0m16:01:04.581210 [info ] [Thread-2 (]: 9 of 32 PASS not_null_dim_time_full_date ....................................... [[32mPASS[0m in 0.82s]
[0m16:01:04.581780 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m16:01:04.582211 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m16:01:04.582736 [info ] [Thread-2 (]: 13 of 32 START test not_null_fact_movie_genre_key .............................. [RUN]
[0m16:01:04.583542 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c, now test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6)
[0m16:01:04.583974 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m16:01:04.588162 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6"
[0m16:01:04.588909 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6 (compile): 16:01:04.584176 => 16:01:04.588746
[0m16:01:04.589166 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m16:01:04.591201 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6"
[0m16:01:04.591899 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6"
[0m16:01:04.592161 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genre_key
from TMDB_DW.ANALYTICS_analytics.fact_movie
where genre_key is null



      
    ) dbt_internal_test
[0m16:01:04.592411 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:04.803179 [info ] [Thread-3 (]: 10 of 32 PASS not_null_fact_credit_credit_key .................................. [[32mPASS[0m in 0.81s]
[0m16:01:04.803917 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m16:01:04.804290 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m16:01:04.804715 [info ] [Thread-3 (]: 14 of 32 START test not_null_fact_movie_movie_id ............................... [RUN]
[0m16:01:04.805397 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f, now test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae)
[0m16:01:04.805733 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m16:01:04.809863 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae"
[0m16:01:04.810449 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae (compile): 16:01:04.805933 => 16:01:04.810279
[0m16:01:04.810721 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m16:01:04.813875 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae"
[0m16:01:04.814603 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae"
[0m16:01:04.814882 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from TMDB_DW.ANALYTICS_analytics.fact_movie
where movie_id is null



      
    ) dbt_internal_test
[0m16:01:04.815151 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:05.289758 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:05.294085 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c (execute): 16:01:04.034022 => 16:01:05.293701
[0m16:01:05.294727 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c: Close
[0m16:01:05.487487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:05.491702 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4 (execute): 16:01:04.204828 => 16:01:05.491327
[0m16:01:05.492364 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4: Close
[0m16:01:05.507749 [info ] [Thread-4 (]: 11 of 32 PASS not_null_fact_credit_movie_key ................................... [[32mPASS[0m in 1.48s]
[0m16:01:05.508552 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m16:01:05.509018 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m16:01:05.509574 [info ] [Thread-4 (]: 15 of 32 START test not_null_fact_movie_movie_key .............................. [RUN]
[0m16:01:05.510507 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c, now test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645)
[0m16:01:05.510938 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m16:01:05.515740 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645"
[0m16:01:05.516593 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645 (compile): 16:01:05.511185 => 16:01:05.516395
[0m16:01:05.516908 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m16:01:05.519071 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645"
[0m16:01:05.520290 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645"
[0m16:01:05.520668 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_key
from TMDB_DW.ANALYTICS_analytics.fact_movie
where movie_key is null



      
    ) dbt_internal_test
[0m16:01:05.520977 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:05.690016 [info ] [Thread-1 (]: 12 of 32 PASS not_null_fact_credit_person_key .................................. [[32mPASS[0m in 1.49s]
[0m16:01:05.690481 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m16:01:05.690763 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m16:01:05.691084 [info ] [Thread-1 (]: 16 of 32 START test not_null_stg_credits_credit_id ............................. [RUN]
[0m16:01:05.691650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4, now test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812)
[0m16:01:05.691910 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m16:01:05.695007 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812"
[0m16:01:05.696325 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812 (compile): 16:01:05.692063 => 16:01:05.696138
[0m16:01:05.696576 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m16:01:05.698294 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812"
[0m16:01:05.698879 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812"
[0m16:01:05.699100 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select credit_id
from TMDB_DW.ANALYTICS_staging.stg_credits
where credit_id is null



      
    ) dbt_internal_test
[0m16:01:05.699310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:05.797377 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:05.799058 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6 (execute): 16:01:04.589317 => 16:01:05.798862
[0m16:01:05.799407 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6: Close
[0m16:01:06.008137 [info ] [Thread-2 (]: 13 of 32 PASS not_null_fact_movie_genre_key .................................... [[32mPASS[0m in 1.42s]
[0m16:01:06.009185 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m16:01:06.009689 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m16:01:06.010091 [info ] [Thread-2 (]: 17 of 32 START test not_null_stg_credits_movie_id .............................. [RUN]
[0m16:01:06.011020 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6, now test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea)
[0m16:01:06.011540 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m16:01:06.016517 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea"
[0m16:01:06.017367 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea (compile): 16:01:06.011810 => 16:01:06.017165
[0m16:01:06.017687 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m16:01:06.019770 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea"
[0m16:01:06.020546 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea"
[0m16:01:06.020818 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from TMDB_DW.ANALYTICS_staging.stg_credits
where movie_id is null



      
    ) dbt_internal_test
[0m16:01:06.021076 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:06.029706 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:06.031860 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae (execute): 16:01:04.810896 => 16:01:06.031705
[0m16:01:06.032213 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae: Close
[0m16:01:06.262507 [info ] [Thread-3 (]: 14 of 32 PASS not_null_fact_movie_movie_id ..................................... [[32mPASS[0m in 1.46s]
[0m16:01:06.263112 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m16:01:06.263451 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m16:01:06.263820 [info ] [Thread-3 (]: 18 of 32 START test not_null_stg_credits_person_id ............................. [RUN]
[0m16:01:06.264459 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae, now test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2)
[0m16:01:06.264770 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m16:01:06.268261 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2"
[0m16:01:06.268850 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2 (compile): 16:01:06.264943 => 16:01:06.268696
[0m16:01:06.269098 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m16:01:06.270920 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2"
[0m16:01:06.271586 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2"
[0m16:01:06.271844 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select person_id
from TMDB_DW.ANALYTICS_staging.stg_credits
where person_id is null



      
    ) dbt_internal_test
[0m16:01:06.272070 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:06.670651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:06.674842 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812 (execute): 16:01:05.696723 => 16:01:06.674429
[0m16:01:06.675481 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812: Close
[0m16:01:06.679308 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:06.681133 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645 (execute): 16:01:05.517108 => 16:01:06.680923
[0m16:01:06.681474 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645: Close
[0m16:01:06.752436 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:06.756120 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea (execute): 16:01:06.017854 => 16:01:06.755768
[0m16:01:06.756545 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea: Close
[0m16:01:06.900086 [info ] [Thread-4 (]: 15 of 32 PASS not_null_fact_movie_movie_key .................................... [[32mPASS[0m in 1.39s]
[0m16:01:06.901816 [info ] [Thread-1 (]: 16 of 32 PASS not_null_stg_credits_credit_id ................................... [[32mPASS[0m in 1.21s]
[0m16:01:06.903160 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m16:01:06.903813 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m16:01:06.904320 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m16:01:06.904898 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m16:01:06.905504 [info ] [Thread-4 (]: 19 of 32 START test not_null_stg_movies_movie_id ............................... [RUN]
[0m16:01:06.905976 [info ] [Thread-1 (]: 20 of 32 START test not_null_stg_movies_release_date ........................... [RUN]
[0m16:01:06.906692 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645, now test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e)
[0m16:01:06.907306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812, now test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246)
[0m16:01:06.907667 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m16:01:06.908005 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m16:01:06.913885 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e"
[0m16:01:06.917226 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246"
[0m16:01:06.918019 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e (compile): 16:01:06.908223 => 16:01:06.917864
[0m16:01:06.918389 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246 (compile): 16:01:06.914085 => 16:01:06.918167
[0m16:01:06.918694 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m16:01:06.918955 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m16:01:06.920877 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e"
[0m16:01:06.922604 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246"
[0m16:01:06.923317 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e"
[0m16:01:06.923761 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246"
[0m16:01:06.923968 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from TMDB_DW.ANALYTICS_staging.stg_movies
where movie_id is null



      
    ) dbt_internal_test
[0m16:01:06.924204 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from TMDB_DW.ANALYTICS_staging.stg_movies
where release_date is null



      
    ) dbt_internal_test
[0m16:01:06.924421 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:06.924615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:06.937526 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:06.939693 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2 (execute): 16:01:06.269252 => 16:01:06.939551
[0m16:01:06.940738 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2: Close
[0m16:01:06.961268 [info ] [Thread-2 (]: 17 of 32 PASS not_null_stg_credits_movie_id .................................... [[32mPASS[0m in 0.95s]
[0m16:01:06.961598 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m16:01:06.961806 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m16:01:06.962031 [info ] [Thread-2 (]: 21 of 32 START test not_null_stg_movies_title .................................. [RUN]
[0m16:01:06.962404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea, now test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a)
[0m16:01:06.962583 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m16:01:06.965005 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a"
[0m16:01:06.965396 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a (compile): 16:01:06.962691 => 16:01:06.965287
[0m16:01:06.965562 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m16:01:06.966850 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a"
[0m16:01:06.967292 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a"
[0m16:01:06.967463 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from TMDB_DW.ANALYTICS_staging.stg_movies
where title is null



      
    ) dbt_internal_test
[0m16:01:06.967622 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:07.143860 [info ] [Thread-3 (]: 18 of 32 PASS not_null_stg_credits_person_id ................................... [[32mPASS[0m in 0.88s]
[0m16:01:07.144296 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m16:01:07.144552 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m16:01:07.144772 [info ] [Thread-3 (]: 22 of 32 START test unique_dim_company_company_id .............................. [RUN]
[0m16:01:07.145254 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2, now test.tmdb_analytics.unique_dim_company_company_id.83514dc60d)
[0m16:01:07.145530 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m16:01:07.149769 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_company_company_id.83514dc60d"
[0m16:01:07.150195 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_id.83514dc60d (compile): 16:01:07.145673 => 16:01:07.150078
[0m16:01:07.150383 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m16:01:07.151875 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_company_company_id.83514dc60d"
[0m16:01:07.152477 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_company_company_id.83514dc60d"
[0m16:01:07.152679 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_dim_company_company_id.83514dc60d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_company_company_id.83514dc60d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company_id as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_company
where company_id is not null
group by company_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:01:07.152866 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:07.672372 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:07.676166 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e (execute): 16:01:06.919114 => 16:01:07.675812
[0m16:01:07.676725 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e: Close
[0m16:01:07.694473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:07.695500 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:07.698237 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246 (execute): 16:01:06.921055 => 16:01:07.697875
[0m16:01:07.700251 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a (execute): 16:01:06.965664 => 16:01:07.700037
[0m16:01:07.700620 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246: Close
[0m16:01:07.700943 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a: Close
[0m16:01:07.903719 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:07.907796 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_id.83514dc60d (execute): 16:01:07.150498 => 16:01:07.907445
[0m16:01:07.908446 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_dim_company_company_id.83514dc60d: Close
[0m16:01:07.922710 [info ] [Thread-2 (]: 21 of 32 PASS not_null_stg_movies_title ........................................ [[32mPASS[0m in 0.96s]
[0m16:01:07.923534 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m16:01:07.924517 [info ] [Thread-4 (]: 19 of 32 PASS not_null_stg_movies_movie_id ..................................... [[32mPASS[0m in 1.02s]
[0m16:01:07.925117 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m16:01:07.926106 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m16:01:07.926475 [info ] [Thread-2 (]: 23 of 32 START test unique_dim_company_company_key ............................. [RUN]
[0m16:01:07.926862 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m16:01:07.927451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a, now test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0)
[0m16:01:07.928201 [info ] [Thread-1 (]: 20 of 32 PASS not_null_stg_movies_release_date ................................. [[32mPASS[0m in 1.02s]
[0m16:01:07.928542 [info ] [Thread-4 (]: 24 of 32 START test unique_dim_genre_genre_id .................................. [RUN]
[0m16:01:07.928878 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m16:01:07.929316 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m16:01:07.929861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e, now test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc)
[0m16:01:07.934407 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0"
[0m16:01:07.934745 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m16:01:07.935009 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m16:01:07.935382 [info ] [Thread-1 (]: 25 of 32 START test unique_dim_genre_genre_key ................................. [RUN]
[0m16:01:07.938860 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc"
[0m16:01:07.939353 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0 (compile): 16:01:07.930072 => 16:01:07.939126
[0m16:01:07.939870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246, now test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d)
[0m16:01:07.940232 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m16:01:07.940496 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m16:01:07.942468 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0"
[0m16:01:07.942787 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc (compile): 16:01:07.935673 => 16:01:07.942642
[0m16:01:07.945391 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d"
[0m16:01:07.945673 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m16:01:07.946222 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0"
[0m16:01:07.948872 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc"
[0m16:01:07.949157 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_company
where company_key is not null
group by company_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:01:07.949429 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d (compile): 16:01:07.942934 => 16:01:07.949299
[0m16:01:07.949690 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:07.949940 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m16:01:07.950385 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc"
[0m16:01:07.952179 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d"
[0m16:01:07.952501 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    genre_id as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_genre
where genre_id is not null
group by genre_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:01:07.953334 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:07.954156 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d"
[0m16:01:07.958042 [debug] [Thread-1 (]: On test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    genre_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_genre
where genre_key is not null
group by genre_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:01:07.958861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:08.129258 [info ] [Thread-3 (]: 22 of 32 PASS unique_dim_company_company_id .................................... [[32mPASS[0m in 0.98s]
[0m16:01:08.129648 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m16:01:08.129880 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m16:01:08.130079 [info ] [Thread-3 (]: 26 of 32 START test unique_dim_person_person_id ................................ [RUN]
[0m16:01:08.130529 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_company_company_id.83514dc60d, now test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d)
[0m16:01:08.130770 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m16:01:08.133430 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d"
[0m16:01:08.133879 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d (compile): 16:01:08.130920 => 16:01:08.133753
[0m16:01:08.134083 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m16:01:08.135565 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d"
[0m16:01:08.136110 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d"
[0m16:01:08.136294 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    person_id as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_person
where person_id is not null
group by person_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:01:08.136467 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:08.547331 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:08.549998 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0 (execute): 16:01:07.940704 => 16:01:08.549711
[0m16:01:08.550470 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0: Close
[0m16:01:08.616504 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:08.620844 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc (execute): 16:01:07.946393 => 16:01:08.620497
[0m16:01:08.621544 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc: Close
[0m16:01:08.629225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:08.631482 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d (execute): 16:01:07.950786 => 16:01:08.631238
[0m16:01:08.631857 [debug] [Thread-1 (]: On test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d: Close
[0m16:01:08.766277 [info ] [Thread-2 (]: 23 of 32 PASS unique_dim_company_company_key ................................... [[32mPASS[0m in 0.84s]
[0m16:01:08.767222 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m16:01:08.767719 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m16:01:08.768293 [info ] [Thread-2 (]: 27 of 32 START test unique_dim_person_person_key ............................... [RUN]
[0m16:01:08.769176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0, now test.tmdb_analytics.unique_dim_person_person_key.5658ff842e)
[0m16:01:08.769573 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m16:01:08.774476 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_person_person_key.5658ff842e"
[0m16:01:08.775365 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_key.5658ff842e (compile): 16:01:08.769782 => 16:01:08.775158
[0m16:01:08.775683 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m16:01:08.777779 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_person_person_key.5658ff842e"
[0m16:01:08.778612 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_person_person_key.5658ff842e"
[0m16:01:08.778890 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_dim_person_person_key.5658ff842e: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_person_person_key.5658ff842e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    person_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_person
where person_key is not null
group by person_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:01:08.779151 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:08.824541 [info ] [Thread-4 (]: 24 of 32 PASS unique_dim_genre_genre_id ........................................ [[32mPASS[0m in 0.89s]
[0m16:01:08.825011 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m16:01:08.825288 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m16:01:08.825577 [info ] [Thread-4 (]: 28 of 32 START test unique_dim_time_date_key ................................... [RUN]
[0m16:01:08.826038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc, now test.tmdb_analytics.unique_dim_time_date_key.c815c3216d)
[0m16:01:08.826267 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m16:01:08.829276 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_time_date_key.c815c3216d"
[0m16:01:08.829726 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_time_date_key.c815c3216d (compile): 16:01:08.826412 => 16:01:08.829601
[0m16:01:08.829928 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m16:01:08.831518 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_time_date_key.c815c3216d"
[0m16:01:08.832129 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_time_date_key.c815c3216d"
[0m16:01:08.832348 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_dim_time_date_key.c815c3216d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_time_date_key.c815c3216d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_time
where date_key is not null
group by date_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:01:08.832550 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:08.840911 [info ] [Thread-1 (]: 25 of 32 PASS unique_dim_genre_genre_key ....................................... [[32mPASS[0m in 0.90s]
[0m16:01:08.841895 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m16:01:08.842518 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m16:01:08.842897 [info ] [Thread-1 (]: 29 of 32 START test unique_fact_credit_credit_key .............................. [RUN]
[0m16:01:08.844386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d, now test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee)
[0m16:01:08.844599 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m16:01:08.847661 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee"
[0m16:01:08.848250 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee (compile): 16:01:08.844836 => 16:01:08.848130
[0m16:01:08.849378 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m16:01:08.850937 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee"
[0m16:01:08.851751 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee"
[0m16:01:08.851950 [debug] [Thread-1 (]: On test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    credit_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.fact_credit
where credit_key is not null
group by credit_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:01:08.852113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:08.910673 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:08.911832 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d (execute): 16:01:08.134201 => 16:01:08.911706
[0m16:01:08.912042 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d: Close
[0m16:01:09.136645 [info ] [Thread-3 (]: 26 of 32 PASS unique_dim_person_person_id ...................................... [[32mPASS[0m in 1.01s]
[0m16:01:09.137442 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m16:01:09.137899 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m16:01:09.138409 [info ] [Thread-3 (]: 30 of 32 START test unique_fact_movie_movie_key ................................ [RUN]
[0m16:01:09.139130 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d, now test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da)
[0m16:01:09.139459 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m16:01:09.143960 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da"
[0m16:01:09.146143 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da (compile): 16:01:09.139661 => 16:01:09.145971
[0m16:01:09.146409 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m16:01:09.148515 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da"
[0m16:01:09.149329 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da"
[0m16:01:09.149604 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    movie_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.fact_movie
where movie_key is not null
group by movie_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:01:09.149867 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:09.348701 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:09.350187 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_key.5658ff842e (execute): 16:01:08.775856 => 16:01:09.350020
[0m16:01:09.350449 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_dim_person_person_key.5658ff842e: Close
[0m16:01:09.553002 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:09.558145 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_time_date_key.c815c3216d (execute): 16:01:08.830054 => 16:01:09.557804
[0m16:01:09.561560 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_dim_time_date_key.c815c3216d: Close
[0m16:01:09.562709 [info ] [Thread-2 (]: 27 of 32 PASS unique_dim_person_person_key ..................................... [[32mPASS[0m in 0.79s]
[0m16:01:09.564424 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m16:01:09.564837 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m16:01:09.565483 [info ] [Thread-2 (]: 31 of 32 START test unique_stg_credits_credit_id ............................... [RUN]
[0m16:01:09.566353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_person_person_key.5658ff842e, now test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1)
[0m16:01:09.567144 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m16:01:09.571678 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1"
[0m16:01:09.573100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:09.574773 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee (execute): 16:01:08.849597 => 16:01:09.574597
[0m16:01:09.575144 [debug] [Thread-1 (]: On test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee: Close
[0m16:01:09.575445 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1 (compile): 16:01:09.567517 => 16:01:09.575306
[0m16:01:09.576449 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m16:01:09.578655 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1"
[0m16:01:09.579442 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1"
[0m16:01:09.579702 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    credit_id as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_staging.stg_credits
where credit_id is not null
group by credit_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:01:09.579933 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:09.782007 [info ] [Thread-4 (]: 28 of 32 PASS unique_dim_time_date_key ......................................... [[32mPASS[0m in 0.96s]
[0m16:01:09.782622 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m16:01:09.782944 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m16:01:09.783220 [info ] [Thread-4 (]: 32 of 32 START test unique_stg_movies_movie_id ................................. [RUN]
[0m16:01:09.783787 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_time_date_key.c815c3216d, now test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78)
[0m16:01:09.784122 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m16:01:09.787690 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78"
[0m16:01:09.788295 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78 (compile): 16:01:09.784304 => 16:01:09.788120
[0m16:01:09.788558 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m16:01:09.790336 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78"
[0m16:01:09.791044 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78"
[0m16:01:09.791298 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    movie_id as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_staging.stg_movies
where movie_id is not null
group by movie_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:01:09.791545 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:09.796556 [info ] [Thread-1 (]: 29 of 32 PASS unique_fact_credit_credit_key .................................... [[32mPASS[0m in 0.95s]
[0m16:01:09.798111 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m16:01:09.944803 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:09.946172 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da (execute): 16:01:09.146572 => 16:01:09.946023
[0m16:01:09.946410 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da: Close
[0m16:01:10.163753 [info ] [Thread-3 (]: 30 of 32 PASS unique_fact_movie_movie_key ...................................... [[32mPASS[0m in 1.02s]
[0m16:01:10.164888 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m16:01:10.453716 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:10.457874 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1 (execute): 16:01:09.576786 => 16:01:10.457522
[0m16:01:10.458531 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1: Close
[0m16:01:10.464400 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:10.466685 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78 (execute): 16:01:09.788699 => 16:01:10.466435
[0m16:01:10.467132 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78: Close
[0m16:01:10.683523 [info ] [Thread-4 (]: 32 of 32 PASS unique_stg_movies_movie_id ....................................... [[32mPASS[0m in 0.90s]
[0m16:01:10.684568 [info ] [Thread-2 (]: 31 of 32 PASS unique_stg_credits_credit_id ..................................... [[32mPASS[0m in 1.12s]
[0m16:01:10.685571 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m16:01:10.686096 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m16:01:10.688166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:10.688471 [debug] [MainThread]: Connection 'test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee' was properly closed.
[0m16:01:10.688718 [debug] [MainThread]: Connection 'test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1' was properly closed.
[0m16:01:10.688947 [debug] [MainThread]: Connection 'test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da' was properly closed.
[0m16:01:10.689170 [debug] [MainThread]: Connection 'test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78' was properly closed.
[0m16:01:10.689448 [info ] [MainThread]: 
[0m16:01:10.689725 [info ] [MainThread]: Finished running 32 tests in 0 hours 0 minutes and 15.17 seconds (15.17s).
[0m16:01:10.692934 [debug] [MainThread]: Command end result
[0m16:01:10.702106 [info ] [MainThread]: 
[0m16:01:10.702394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:10.702621 [info ] [MainThread]: 
[0m16:01:10.702843 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m16:01:10.705702 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 15.638462, "process_user_time": 3.256569, "process_kernel_time": 0.532429, "process_mem_max_rss": "224526336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:01:10.706015 [debug] [MainThread]: Command `dbt test` succeeded at 16:01:10.705941 after 15.64 seconds
[0m16:01:10.706225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eee2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5ea80>]}
[0m16:01:10.706450 [debug] [MainThread]: Flushing usage events
[0m16:06:06.556057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ba780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106491bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106491940>]}


============================== 16:06:06.557717 | 23551c0b-d2c5-4fa4-be3f-595dbb0d40ff ==============================
[0m16:06:06.557717 [info ] [MainThread]: Running with dbt=1.7.18
[0m16:06:06.557957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project/logs', 'profiles_dir': '/Users/dipinjassal/ml/tmdb_data_warehouse/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:06:06.839974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23551c0b-d2c5-4fa4-be3f-595dbb0d40ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e02d50>]}
[0m16:06:06.858337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23551c0b-d2c5-4fa4-be3f-595dbb0d40ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b4e930>]}
[0m16:06:06.858613 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m16:06:06.866490 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m16:06:06.879139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:06.879305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:06.881959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23551c0b-d2c5-4fa4-be3f-595dbb0d40ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f810a0>]}
[0m16:06:06.887210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23551c0b-d2c5-4fa4-be3f-595dbb0d40ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fb7a10>]}
[0m16:06:06.887387 [info ] [MainThread]: Found 9 models, 32 tests, 4 sources, 0 exposures, 0 metrics, 460 macros, 0 groups, 0 semantic models
[0m16:06:06.887546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23551c0b-d2c5-4fa4-be3f-595dbb0d40ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fe8380>]}
[0m16:06:06.888759 [info ] [MainThread]: 
[0m16:06:06.889068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:06:06.889683 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW_ANALYTICS_staging'
[0m16:06:06.890022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TMDB_DW_ANALYTICS_analytics'
[0m16:06:06.895868 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_staging"
[0m16:06:06.896944 [debug] [ThreadPool]: Using snowflake connection "list_TMDB_DW_ANALYTICS_analytics"
[0m16:06:06.897132 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_staging"} */
show objects in TMDB_DW.ANALYTICS_staging limit 10000
[0m16:06:06.897280 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "connection_name": "list_TMDB_DW_ANALYTICS_analytics"} */
show objects in TMDB_DW.ANALYTICS_analytics limit 10000
[0m16:06:06.897412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:06.897529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:10.535059 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 4.0 seconds
[0m16:06:10.541877 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_staging: Close
[0m16:06:10.543960 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 4.0 seconds
[0m16:06:10.545770 [debug] [ThreadPool]: On list_TMDB_DW_ANALYTICS_analytics: Close
[0m16:06:10.768925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23551c0b-d2c5-4fa4-be3f-595dbb0d40ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b956d0>]}
[0m16:06:10.770154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:06:10.770516 [info ] [MainThread]: 
[0m16:06:10.773651 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m16:06:10.774068 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m16:06:10.774465 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m16:06:10.775192 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m16:06:10.774858 [info ] [Thread-1 (]: 1 of 32 START test not_null_dim_company_company_id ............................. [RUN]
[0m16:06:10.775660 [info ] [Thread-2 (]: 2 of 32 START test not_null_dim_company_company_key ............................ [RUN]
[0m16:06:10.775989 [info ] [Thread-3 (]: 3 of 32 START test not_null_dim_genre_genre_id ................................. [RUN]
[0m16:06:10.776289 [info ] [Thread-4 (]: 4 of 32 START test not_null_dim_genre_genre_key ................................ [RUN]
[0m16:06:10.776867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_staging, now test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78)
[0m16:06:10.777362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TMDB_DW_ANALYTICS_analytics, now test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb)
[0m16:06:10.777881 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c'
[0m16:06:10.778403 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a'
[0m16:06:10.778668 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m16:06:10.778927 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m16:06:10.779172 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m16:06:10.779413 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m16:06:10.790789 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78"
[0m16:06:10.793265 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb"
[0m16:06:10.795547 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c"
[0m16:06:10.797604 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a"
[0m16:06:10.798229 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb (compile): 16:06:10.790978 => 16:06:10.798094
[0m16:06:10.798495 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78 (compile): 16:06:10.779592 => 16:06:10.798358
[0m16:06:10.798719 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a (compile): 16:06:10.795685 => 16:06:10.798613
[0m16:06:10.798958 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c (compile): 16:06:10.793435 => 16:06:10.798845
[0m16:06:10.799137 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m16:06:10.799329 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m16:06:10.799513 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m16:06:10.799693 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m16:06:10.810633 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb"
[0m16:06:10.812919 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78"
[0m16:06:10.814174 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a"
[0m16:06:10.815383 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c"
[0m16:06:10.816067 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78"
[0m16:06:10.816421 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb"
[0m16:06:10.816744 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c"
[0m16:06:10.817083 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a"
[0m16:06:10.817254 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_id
from TMDB_DW.ANALYTICS_analytics.dim_company
where company_id is null



      
    ) dbt_internal_test
[0m16:06:10.817444 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_key
from TMDB_DW.ANALYTICS_analytics.dim_company
where company_key is null



      
    ) dbt_internal_test
[0m16:06:10.817624 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genre_id
from TMDB_DW.ANALYTICS_analytics.dim_genre
where genre_id is null



      
    ) dbt_internal_test
[0m16:06:10.817797 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genre_key
from TMDB_DW.ANALYTICS_analytics.dim_genre
where genre_key is null



      
    ) dbt_internal_test
[0m16:06:10.817964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:10.818130 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:10.818303 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:06:10.818469 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:06:13.117674 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:06:13.128905 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c (execute): 16:06:10.814303 => 16:06:13.128592
[0m16:06:13.129626 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:06:13.130129 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c: Close
[0m16:06:13.132059 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb (execute): 16:06:10.799814 => 16:06:13.131825
[0m16:06:13.133463 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb: Close
[0m16:06:13.214888 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:06:13.215862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:06:13.218086 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a (execute): 16:06:10.813074 => 16:06:13.217860
[0m16:06:13.219725 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78 (execute): 16:06:10.810838 => 16:06:13.219526
[0m16:06:13.220098 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a: Close
[0m16:06:13.220412 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78: Close
[0m16:06:13.341498 [info ] [Thread-2 (]: 2 of 32 PASS not_null_dim_company_company_key .................................. [[32mPASS[0m in 2.56s]
[0m16:06:13.342093 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb
[0m16:06:13.342447 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m16:06:13.342816 [info ] [Thread-2 (]: 5 of 32 START test not_null_dim_genre_genre_name ............................... [RUN]
[0m16:06:13.343355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_company_company_key.3585db4feb, now test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3)
[0m16:06:13.343611 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m16:06:13.347504 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3"
[0m16:06:13.348088 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3 (compile): 16:06:13.343767 => 16:06:13.347928
[0m16:06:13.348382 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m16:06:13.350224 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3"
[0m16:06:13.350902 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3"
[0m16:06:13.351414 [info ] [Thread-3 (]: 3 of 32 PASS not_null_dim_genre_genre_id ....................................... [[32mPASS[0m in 2.57s]
[0m16:06:13.351674 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genre_name
from TMDB_DW.ANALYTICS_analytics.dim_genre
where genre_name is null



      
    ) dbt_internal_test
[0m16:06:13.351999 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c
[0m16:06:13.352215 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:13.352464 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m16:06:13.353032 [info ] [Thread-3 (]: 6 of 32 START test not_null_dim_person_person_id ............................... [RUN]
[0m16:06:13.354403 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_genre_genre_id.9bb76b166c, now test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94)
[0m16:06:13.356224 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m16:06:13.359422 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94"
[0m16:06:13.363033 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94 (compile): 16:06:13.357084 => 16:06:13.362922
[0m16:06:13.363574 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m16:06:13.366699 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94"
[0m16:06:13.368728 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94"
[0m16:06:13.369091 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select person_id
from TMDB_DW.ANALYTICS_analytics.dim_person
where person_id is null



      
    ) dbt_internal_test
[0m16:06:13.369273 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:13.443502 [info ] [Thread-4 (]: 4 of 32 PASS not_null_dim_genre_genre_key ...................................... [[32mPASS[0m in 2.67s]
[0m16:06:13.443971 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a
[0m16:06:13.444232 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m16:06:13.444492 [info ] [Thread-4 (]: 7 of 32 START test not_null_dim_person_person_key .............................. [RUN]
[0m16:06:13.444933 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_genre_genre_key.8e892f808a, now test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692)
[0m16:06:13.445136 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m16:06:13.447919 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692"
[0m16:06:13.448346 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692 (compile): 16:06:13.445258 => 16:06:13.448224
[0m16:06:13.448546 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m16:06:13.450020 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692"
[0m16:06:13.450742 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692"
[0m16:06:13.450948 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select person_key
from TMDB_DW.ANALYTICS_analytics.dim_person
where person_key is null



      
    ) dbt_internal_test
[0m16:06:13.451147 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:13.451622 [info ] [Thread-1 (]: 1 of 32 PASS not_null_dim_company_company_id ................................... [[32mPASS[0m in 2.68s]
[0m16:06:13.452917 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78
[0m16:06:13.454444 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m16:06:13.455160 [info ] [Thread-1 (]: 8 of 32 START test not_null_dim_time_date_key .................................. [RUN]
[0m16:06:13.456555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_company_company_id.a0d172ad78, now test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec)
[0m16:06:13.457307 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m16:06:13.459901 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec"
[0m16:06:13.461246 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec (compile): 16:06:13.457822 => 16:06:13.461138
[0m16:06:13.461559 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m16:06:13.462865 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec"
[0m16:06:13.463594 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec"
[0m16:06:13.464138 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_key
from TMDB_DW.ANALYTICS_analytics.dim_time
where date_key is null



      
    ) dbt_internal_test
[0m16:06:13.464517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:13.884060 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:13.888523 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94 (execute): 16:06:13.365343 => 16:06:13.888189
[0m16:06:13.889024 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94: Close
[0m16:06:14.006738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:14.010732 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec (execute): 16:06:13.461703 => 16:06:14.010401
[0m16:06:14.011493 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec: Close
[0m16:06:14.130846 [info ] [Thread-3 (]: 6 of 32 PASS not_null_dim_person_person_id ..................................... [[32mPASS[0m in 0.78s]
[0m16:06:14.132494 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94
[0m16:06:14.133176 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m16:06:14.133771 [info ] [Thread-3 (]: 9 of 32 START test not_null_dim_time_full_date ................................. [RUN]
[0m16:06:14.134774 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_person_person_id.28c5a93a94, now test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c)
[0m16:06:14.135212 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m16:06:14.140322 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c"
[0m16:06:14.141150 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c (compile): 16:06:14.135468 => 16:06:14.140957
[0m16:06:14.141475 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m16:06:14.143612 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c"
[0m16:06:14.144350 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c"
[0m16:06:14.144623 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select full_date
from TMDB_DW.ANALYTICS_analytics.dim_time
where full_date is null



      
    ) dbt_internal_test
[0m16:06:14.144880 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:14.231848 [info ] [Thread-1 (]: 8 of 32 PASS not_null_dim_time_date_key ........................................ [[32mPASS[0m in 0.78s]
[0m16:06:14.232509 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec
[0m16:06:14.232889 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m16:06:14.233313 [info ] [Thread-1 (]: 10 of 32 START test not_null_fact_credit_credit_key ............................ [RUN]
[0m16:06:14.233994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_time_date_key.668b84ffec, now test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f)
[0m16:06:14.234321 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m16:06:14.238114 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f"
[0m16:06:14.238682 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f (compile): 16:06:14.234521 => 16:06:14.238512
[0m16:06:14.238946 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m16:06:14.240968 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f"
[0m16:06:14.241643 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f"
[0m16:06:14.241913 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select credit_key
from TMDB_DW.ANALYTICS_analytics.fact_credit
where credit_key is null



      
    ) dbt_internal_test
[0m16:06:14.242176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:14.581549 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:14.583673 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3 (execute): 16:06:13.348715 => 16:06:14.583470
[0m16:06:14.583965 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3: Close
[0m16:06:14.650682 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:14.654566 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692 (execute): 16:06:13.448662 => 16:06:14.654170
[0m16:06:14.655312 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692: Close
[0m16:06:14.710447 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:14.715132 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c (execute): 16:06:14.141664 => 16:06:14.714705
[0m16:06:14.716133 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c: Close
[0m16:06:14.783748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:14.786433 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f (execute): 16:06:14.239109 => 16:06:14.786144
[0m16:06:14.786863 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f: Close
[0m16:06:14.812599 [info ] [Thread-2 (]: 5 of 32 PASS not_null_dim_genre_genre_name ..................................... [[32mPASS[0m in 1.47s]
[0m16:06:14.813375 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3
[0m16:06:14.813842 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m16:06:14.814319 [info ] [Thread-2 (]: 11 of 32 START test not_null_fact_credit_movie_key ............................. [RUN]
[0m16:06:14.815037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_genre_genre_name.25df20f8f3, now test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c)
[0m16:06:14.815356 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m16:06:14.820525 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c"
[0m16:06:14.821352 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c (compile): 16:06:14.815553 => 16:06:14.821176
[0m16:06:14.821649 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m16:06:14.823791 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c"
[0m16:06:14.824565 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c"
[0m16:06:14.824839 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_key
from TMDB_DW.ANALYTICS_analytics.fact_credit
where movie_key is null



      
    ) dbt_internal_test
[0m16:06:14.825110 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:14.862794 [info ] [Thread-4 (]: 7 of 32 PASS not_null_dim_person_person_key .................................... [[32mPASS[0m in 1.42s]
[0m16:06:14.863286 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692
[0m16:06:14.863557 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m16:06:14.863851 [info ] [Thread-4 (]: 12 of 32 START test not_null_fact_credit_person_key ............................ [RUN]
[0m16:06:14.864346 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_person_person_key.14d9c70692, now test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4)
[0m16:06:14.864582 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m16:06:14.867983 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4"
[0m16:06:14.868405 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4 (compile): 16:06:14.864722 => 16:06:14.868284
[0m16:06:14.868599 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m16:06:14.870059 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4"
[0m16:06:14.870547 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4"
[0m16:06:14.870744 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select person_key
from TMDB_DW.ANALYTICS_analytics.fact_credit
where person_key is null



      
    ) dbt_internal_test
[0m16:06:14.870935 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:14.937243 [info ] [Thread-3 (]: 9 of 32 PASS not_null_dim_time_full_date ....................................... [[32mPASS[0m in 0.80s]
[0m16:06:14.937675 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c
[0m16:06:14.937922 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m16:06:14.938223 [info ] [Thread-3 (]: 13 of 32 START test not_null_fact_movie_genre_key .............................. [RUN]
[0m16:06:14.938653 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_dim_time_full_date.0d0ab7298c, now test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6)
[0m16:06:14.938854 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m16:06:14.941368 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6"
[0m16:06:14.941806 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6 (compile): 16:06:14.938973 => 16:06:14.941695
[0m16:06:14.941982 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m16:06:14.943340 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6"
[0m16:06:14.943811 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6"
[0m16:06:14.943991 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select genre_key
from TMDB_DW.ANALYTICS_analytics.fact_movie
where genre_key is null



      
    ) dbt_internal_test
[0m16:06:14.944165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:15.008927 [info ] [Thread-1 (]: 10 of 32 PASS not_null_fact_credit_credit_key .................................. [[32mPASS[0m in 0.78s]
[0m16:06:15.009311 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f
[0m16:06:15.009530 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m16:06:15.009750 [info ] [Thread-1 (]: 14 of 32 START test not_null_fact_movie_movie_id ............................... [RUN]
[0m16:06:15.010106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_credit_credit_key.43fa4afb6f, now test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae)
[0m16:06:15.010275 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m16:06:15.012627 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae"
[0m16:06:15.013020 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae (compile): 16:06:15.010387 => 16:06:15.012917
[0m16:06:15.013191 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m16:06:15.014460 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae"
[0m16:06:15.014880 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae"
[0m16:06:15.015042 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from TMDB_DW.ANALYTICS_analytics.fact_movie
where movie_id is null



      
    ) dbt_internal_test
[0m16:06:15.015199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:15.389280 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:15.391028 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4 (execute): 16:06:14.868715 => 16:06:15.390838
[0m16:06:15.391326 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4: Close
[0m16:06:15.495335 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:15.497630 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6 (execute): 16:06:14.942088 => 16:06:15.497362
[0m16:06:15.498064 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6: Close
[0m16:06:15.567963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:15.572513 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae (execute): 16:06:15.013291 => 16:06:15.572252
[0m16:06:15.572937 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae: Close
[0m16:06:15.597021 [info ] [Thread-4 (]: 12 of 32 PASS not_null_fact_credit_person_key .................................. [[32mPASS[0m in 0.73s]
[0m16:06:15.597738 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4
[0m16:06:15.598180 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m16:06:15.598667 [info ] [Thread-4 (]: 15 of 32 START test not_null_fact_movie_movie_key .............................. [RUN]
[0m16:06:15.599446 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_credit_person_key.886b5a9eb4, now test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645)
[0m16:06:15.599886 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m16:06:15.604814 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645"
[0m16:06:15.605768 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645 (compile): 16:06:15.600101 => 16:06:15.605592
[0m16:06:15.606046 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m16:06:15.608206 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645"
[0m16:06:15.608963 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645"
[0m16:06:15.609233 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_key
from TMDB_DW.ANALYTICS_analytics.fact_movie
where movie_key is null



      
    ) dbt_internal_test
[0m16:06:15.609497 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:15.718712 [info ] [Thread-3 (]: 13 of 32 PASS not_null_fact_movie_genre_key .................................... [[32mPASS[0m in 0.78s]
[0m16:06:15.719310 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6
[0m16:06:15.719653 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m16:06:15.720005 [info ] [Thread-3 (]: 16 of 32 START test not_null_stg_credits_credit_id ............................. [RUN]
[0m16:06:15.720570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_movie_genre_key.5d4b3d81f6, now test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812)
[0m16:06:15.720846 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m16:06:15.724442 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812"
[0m16:06:15.724974 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812 (compile): 16:06:15.721012 => 16:06:15.724830
[0m16:06:15.725257 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m16:06:15.727072 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812"
[0m16:06:15.727694 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812"
[0m16:06:15.727937 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select credit_id
from TMDB_DW.ANALYTICS_staging.stg_credits
where credit_id is null



      
    ) dbt_internal_test
[0m16:06:15.728165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:15.787711 [info ] [Thread-1 (]: 14 of 32 PASS not_null_fact_movie_movie_id ..................................... [[32mPASS[0m in 0.78s]
[0m16:06:15.788181 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae
[0m16:06:15.788448 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m16:06:15.788678 [info ] [Thread-1 (]: 17 of 32 START test not_null_stg_credits_movie_id .............................. [RUN]
[0m16:06:15.789177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_movie_movie_id.115d5160ae, now test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea)
[0m16:06:15.789469 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m16:06:15.792484 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea"
[0m16:06:15.792991 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea (compile): 16:06:15.789628 => 16:06:15.792854
[0m16:06:15.793220 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m16:06:15.794790 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea"
[0m16:06:15.795298 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea"
[0m16:06:15.795497 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from TMDB_DW.ANALYTICS_staging.stg_credits
where movie_id is null



      
    ) dbt_internal_test
[0m16:06:15.795687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:16.026119 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:16.028152 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c (execute): 16:06:14.821821 => 16:06:16.027918
[0m16:06:16.028582 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c: Close
[0m16:06:16.147153 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:16.149676 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645 (execute): 16:06:15.606211 => 16:06:16.149396
[0m16:06:16.150112 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645: Close
[0m16:06:16.252804 [info ] [Thread-2 (]: 11 of 32 PASS not_null_fact_credit_movie_key ................................... [[32mPASS[0m in 1.44s]
[0m16:06:16.254335 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c
[0m16:06:16.255102 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m16:06:16.255773 [info ] [Thread-2 (]: 18 of 32 START test not_null_stg_credits_person_id ............................. [RUN]
[0m16:06:16.257099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_credit_movie_key.bbc21c937c, now test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2)
[0m16:06:16.257803 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m16:06:16.263766 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2"
[0m16:06:16.265006 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2 (compile): 16:06:16.258840 => 16:06:16.264800
[0m16:06:16.265318 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m16:06:16.267487 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2"
[0m16:06:16.268609 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2"
[0m16:06:16.269057 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select person_id
from TMDB_DW.ANALYTICS_staging.stg_credits
where person_id is null



      
    ) dbt_internal_test
[0m16:06:16.269429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:16.352113 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:16.353987 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812 (execute): 16:06:15.725413 => 16:06:16.353773
[0m16:06:16.354329 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812: Close
[0m16:06:16.359418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:16.360961 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea (execute): 16:06:15.793354 => 16:06:16.360771
[0m16:06:16.361255 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea: Close
[0m16:06:16.369232 [info ] [Thread-4 (]: 15 of 32 PASS not_null_fact_movie_movie_key .................................... [[32mPASS[0m in 0.77s]
[0m16:06:16.369636 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645
[0m16:06:16.369911 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m16:06:16.370204 [info ] [Thread-4 (]: 19 of 32 START test not_null_stg_movies_movie_id ............................... [RUN]
[0m16:06:16.370684 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_fact_movie_movie_key.a019045645, now test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e)
[0m16:06:16.370914 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m16:06:16.373961 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e"
[0m16:06:16.374414 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e (compile): 16:06:16.371053 => 16:06:16.374282
[0m16:06:16.374625 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m16:06:16.377132 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e"
[0m16:06:16.377665 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e"
[0m16:06:16.377878 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select movie_id
from TMDB_DW.ANALYTICS_staging.stg_movies
where movie_id is null



      
    ) dbt_internal_test
[0m16:06:16.378067 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:16.556593 [info ] [Thread-3 (]: 16 of 32 PASS not_null_stg_credits_credit_id ................................... [[32mPASS[0m in 0.84s]
[0m16:06:16.557062 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812
[0m16:06:16.557339 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m16:06:16.557649 [info ] [Thread-3 (]: 20 of 32 START test not_null_stg_movies_release_date ........................... [RUN]
[0m16:06:16.558161 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_credits_credit_id.f286674812, now test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246)
[0m16:06:16.558403 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m16:06:16.561695 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246"
[0m16:06:16.562190 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246 (compile): 16:06:16.558547 => 16:06:16.562046
[0m16:06:16.562421 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m16:06:16.564076 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246"
[0m16:06:16.564623 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246"
[0m16:06:16.564849 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select release_date
from TMDB_DW.ANALYTICS_staging.stg_movies
where release_date is null



      
    ) dbt_internal_test
[0m16:06:16.565054 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:16.573186 [info ] [Thread-1 (]: 17 of 32 PASS not_null_stg_credits_movie_id .................................... [[32mPASS[0m in 0.78s]
[0m16:06:16.574614 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea
[0m16:06:16.575592 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m16:06:16.576619 [info ] [Thread-1 (]: 21 of 32 START test not_null_stg_movies_title .................................. [RUN]
[0m16:06:16.577147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_credits_movie_id.d0f480f1ea, now test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a)
[0m16:06:16.577334 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m16:06:16.579556 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a"
[0m16:06:16.579961 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a (compile): 16:06:16.577442 => 16:06:16.579851
[0m16:06:16.581169 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m16:06:16.582521 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a"
[0m16:06:16.583155 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a"
[0m16:06:16.583488 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from TMDB_DW.ANALYTICS_staging.stg_movies
where title is null



      
    ) dbt_internal_test
[0m16:06:16.583680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:16.830987 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:16.832700 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2 (execute): 16:06:16.265501 => 16:06:16.832499
[0m16:06:16.833006 [debug] [Thread-2 (]: On test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2: Close
[0m16:06:16.953653 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:16.956910 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e (execute): 16:06:16.374753 => 16:06:16.956622
[0m16:06:16.957469 [debug] [Thread-4 (]: On test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e: Close
[0m16:06:17.053359 [info ] [Thread-2 (]: 18 of 32 PASS not_null_stg_credits_person_id ................................... [[32mPASS[0m in 0.80s]
[0m16:06:17.057025 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2
[0m16:06:17.057777 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m16:06:17.058386 [info ] [Thread-2 (]: 22 of 32 START test unique_dim_company_company_id .............................. [RUN]
[0m16:06:17.059316 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_credits_person_id.e9071df2a2, now test.tmdb_analytics.unique_dim_company_company_id.83514dc60d)
[0m16:06:17.059733 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m16:06:17.066776 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_company_company_id.83514dc60d"
[0m16:06:17.067977 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_id.83514dc60d (compile): 16:06:17.059975 => 16:06:17.067772
[0m16:06:17.068293 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m16:06:17.070596 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_company_company_id.83514dc60d"
[0m16:06:17.071420 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_company_company_id.83514dc60d"
[0m16:06:17.071718 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_dim_company_company_id.83514dc60d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_company_company_id.83514dc60d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company_id as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_company
where company_id is not null
group by company_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:17.071993 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:17.134971 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:17.136649 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246 (execute): 16:06:16.562559 => 16:06:17.136452
[0m16:06:17.136955 [debug] [Thread-3 (]: On test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246: Close
[0m16:06:17.175386 [info ] [Thread-4 (]: 19 of 32 PASS not_null_stg_movies_movie_id ..................................... [[32mPASS[0m in 0.80s]
[0m16:06:17.176028 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e
[0m16:06:17.176602 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m16:06:17.177024 [info ] [Thread-4 (]: 23 of 32 START test unique_dim_company_company_key ............................. [RUN]
[0m16:06:17.177628 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_movies_movie_id.543dfa639e, now test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0)
[0m16:06:17.177929 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m16:06:17.181756 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0"
[0m16:06:17.182308 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0 (compile): 16:06:17.178117 => 16:06:17.182152
[0m16:06:17.182562 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m16:06:17.184538 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0"
[0m16:06:17.185274 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0"
[0m16:06:17.185542 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    company_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_company
where company_key is not null
group by company_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:17.185770 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:17.208408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:17.209585 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a (execute): 16:06:16.581307 => 16:06:17.209450
[0m16:06:17.209799 [debug] [Thread-1 (]: On test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a: Close
[0m16:06:17.331575 [info ] [Thread-3 (]: 20 of 32 PASS not_null_stg_movies_release_date ................................. [[32mPASS[0m in 0.77s]
[0m16:06:17.332008 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246
[0m16:06:17.332275 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m16:06:17.332535 [info ] [Thread-3 (]: 24 of 32 START test unique_dim_genre_genre_id .................................. [RUN]
[0m16:06:17.332983 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_movies_release_date.f06ba04246, now test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc)
[0m16:06:17.333190 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m16:06:17.336695 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc"
[0m16:06:17.337134 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc (compile): 16:06:17.333311 => 16:06:17.337012
[0m16:06:17.337326 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m16:06:17.338781 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc"
[0m16:06:17.339321 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc"
[0m16:06:17.339518 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    genre_id as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_genre
where genre_id is not null
group by genre_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:17.339706 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:17.422007 [info ] [Thread-1 (]: 21 of 32 PASS not_null_stg_movies_title ........................................ [[32mPASS[0m in 0.84s]
[0m16:06:17.422397 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a
[0m16:06:17.422632 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m16:06:17.422874 [info ] [Thread-1 (]: 25 of 32 START test unique_dim_genre_genre_key ................................. [RUN]
[0m16:06:17.423292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.not_null_stg_movies_title.1c77359c6a, now test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d)
[0m16:06:17.423487 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m16:06:17.425828 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d"
[0m16:06:17.426229 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d (compile): 16:06:17.423594 => 16:06:17.426113
[0m16:06:17.426414 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m16:06:17.427771 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d"
[0m16:06:17.428257 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d"
[0m16:06:17.428443 [debug] [Thread-1 (]: On test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    genre_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_genre
where genre_key is not null
group by genre_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:17.428615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:17.603596 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:17.604899 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_id.83514dc60d (execute): 16:06:17.068473 => 16:06:17.604754
[0m16:06:17.605188 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_dim_company_company_id.83514dc60d: Close
[0m16:06:17.751695 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:17.753893 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0 (execute): 16:06:17.182722 => 16:06:17.753642
[0m16:06:17.754302 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0: Close
[0m16:06:17.822754 [info ] [Thread-2 (]: 22 of 32 PASS unique_dim_company_company_id .................................... [[32mPASS[0m in 0.76s]
[0m16:06:17.823411 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.unique_dim_company_company_id.83514dc60d
[0m16:06:17.823844 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m16:06:17.824380 [info ] [Thread-2 (]: 26 of 32 START test unique_dim_person_person_id ................................ [RUN]
[0m16:06:17.825311 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_company_company_id.83514dc60d, now test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d)
[0m16:06:17.825651 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m16:06:17.830203 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d"
[0m16:06:17.830851 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d (compile): 16:06:17.825917 => 16:06:17.830684
[0m16:06:17.831124 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m16:06:17.833246 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d"
[0m16:06:17.833974 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d"
[0m16:06:17.834218 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    person_id as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_person
where person_id is not null
group by person_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:17.834455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:17.901979 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:17.903565 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc (execute): 16:06:17.337445 => 16:06:17.903384
[0m16:06:17.903850 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc: Close
[0m16:06:17.961347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:17.962459 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d (execute): 16:06:17.426520 => 16:06:17.962328
[0m16:06:17.962670 [debug] [Thread-1 (]: On test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d: Close
[0m16:06:17.969432 [info ] [Thread-4 (]: 23 of 32 PASS unique_dim_company_company_key ................................... [[32mPASS[0m in 0.79s]
[0m16:06:17.969810 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0
[0m16:06:17.970049 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m16:06:17.970248 [info ] [Thread-4 (]: 27 of 32 START test unique_dim_person_person_key ............................... [RUN]
[0m16:06:17.970684 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_company_company_key.3f18c191a0, now test.tmdb_analytics.unique_dim_person_person_key.5658ff842e)
[0m16:06:17.970916 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m16:06:17.973582 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_person_person_key.5658ff842e"
[0m16:06:17.974021 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_key.5658ff842e (compile): 16:06:17.971045 => 16:06:17.973905
[0m16:06:17.974213 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m16:06:17.975671 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_person_person_key.5658ff842e"
[0m16:06:17.976211 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_person_person_key.5658ff842e"
[0m16:06:17.976410 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_dim_person_person_key.5658ff842e: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_person_person_key.5658ff842e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    person_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_person
where person_key is not null
group by person_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:17.976600 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:18.117636 [info ] [Thread-3 (]: 24 of 32 PASS unique_dim_genre_genre_id ........................................ [[32mPASS[0m in 0.78s]
[0m16:06:18.118055 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc
[0m16:06:18.118309 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m16:06:18.118529 [info ] [Thread-3 (]: 28 of 32 START test unique_dim_time_date_key ................................... [RUN]
[0m16:06:18.118952 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_genre_genre_id.757304f7bc, now test.tmdb_analytics.unique_dim_time_date_key.c815c3216d)
[0m16:06:18.119217 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m16:06:18.122150 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.unique_dim_time_date_key.c815c3216d"
[0m16:06:18.122595 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_dim_time_date_key.c815c3216d (compile): 16:06:18.119380 => 16:06:18.122471
[0m16:06:18.122801 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m16:06:18.124262 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.unique_dim_time_date_key.c815c3216d"
[0m16:06:18.124810 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.unique_dim_time_date_key.c815c3216d"
[0m16:06:18.125009 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_dim_time_date_key.c815c3216d: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_dim_time_date_key.c815c3216d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.dim_time
where date_key is not null
group by date_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:18.125194 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:18.182149 [info ] [Thread-1 (]: 25 of 32 PASS unique_dim_genre_genre_key ....................................... [[32mPASS[0m in 0.76s]
[0m16:06:18.182572 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d
[0m16:06:18.182833 [debug] [Thread-1 (]: Began running node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m16:06:18.183103 [info ] [Thread-1 (]: 29 of 32 START test unique_fact_credit_credit_key .............................. [RUN]
[0m16:06:18.183542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_genre_genre_key.addf34477d, now test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee)
[0m16:06:18.183747 [debug] [Thread-1 (]: Began compiling node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m16:06:18.186467 [debug] [Thread-1 (]: Writing injected SQL for node "test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee"
[0m16:06:18.186914 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee (compile): 16:06:18.183872 => 16:06:18.186782
[0m16:06:18.187121 [debug] [Thread-1 (]: Began executing node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m16:06:18.188550 [debug] [Thread-1 (]: Writing runtime sql for node "test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee"
[0m16:06:18.189090 [debug] [Thread-1 (]: Using snowflake connection "test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee"
[0m16:06:18.189288 [debug] [Thread-1 (]: On test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    credit_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.fact_credit
where credit_key is not null
group by credit_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:18.189473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:18.409195 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:18.410875 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d (execute): 16:06:17.831292 => 16:06:18.410688
[0m16:06:18.411176 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d: Close
[0m16:06:18.520521 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:18.522752 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_dim_person_person_key.5658ff842e (execute): 16:06:17.974330 => 16:06:18.522494
[0m16:06:18.523159 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_dim_person_person_key.5658ff842e: Close
[0m16:06:18.616119 [info ] [Thread-2 (]: 26 of 32 PASS unique_dim_person_person_id ...................................... [[32mPASS[0m in 0.79s]
[0m16:06:18.617285 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d
[0m16:06:18.617908 [debug] [Thread-2 (]: Began running node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m16:06:18.618548 [info ] [Thread-2 (]: 30 of 32 START test unique_fact_movie_movie_key ................................ [RUN]
[0m16:06:18.619732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_person_person_id.e5b246bf7d, now test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da)
[0m16:06:18.620327 [debug] [Thread-2 (]: Began compiling node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m16:06:18.625692 [debug] [Thread-2 (]: Writing injected SQL for node "test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da"
[0m16:06:18.627381 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da (compile): 16:06:18.620616 => 16:06:18.627161
[0m16:06:18.627708 [debug] [Thread-2 (]: Began executing node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m16:06:18.630058 [debug] [Thread-2 (]: Writing runtime sql for node "test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da"
[0m16:06:18.631280 [debug] [Thread-2 (]: Using snowflake connection "test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da"
[0m16:06:18.631719 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    movie_key as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_analytics.fact_movie
where movie_key is not null
group by movie_key
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:18.632017 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:18.663051 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:18.664413 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_dim_time_date_key.c815c3216d (execute): 16:06:18.122917 => 16:06:18.664260
[0m16:06:18.664652 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_dim_time_date_key.c815c3216d: Close
[0m16:06:18.736986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:18.739166 [debug] [Thread-1 (]: Timing info for test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee (execute): 16:06:18.187238 => 16:06:18.738916
[0m16:06:18.739819 [debug] [Thread-1 (]: On test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee: Close
[0m16:06:18.742655 [info ] [Thread-4 (]: 27 of 32 PASS unique_dim_person_person_key ..................................... [[32mPASS[0m in 0.77s]
[0m16:06:18.743226 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.unique_dim_person_person_key.5658ff842e
[0m16:06:18.743658 [debug] [Thread-4 (]: Began running node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m16:06:18.744191 [info ] [Thread-4 (]: 31 of 32 START test unique_stg_credits_credit_id ............................... [RUN]
[0m16:06:18.745039 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_person_person_key.5658ff842e, now test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1)
[0m16:06:18.745520 [debug] [Thread-4 (]: Began compiling node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m16:06:18.749278 [debug] [Thread-4 (]: Writing injected SQL for node "test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1"
[0m16:06:18.749898 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1 (compile): 16:06:18.745785 => 16:06:18.749723
[0m16:06:18.750174 [debug] [Thread-4 (]: Began executing node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m16:06:18.753230 [debug] [Thread-4 (]: Writing runtime sql for node "test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1"
[0m16:06:18.753963 [debug] [Thread-4 (]: Using snowflake connection "test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1"
[0m16:06:18.754214 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    credit_id as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_staging.stg_credits
where credit_id is not null
group by credit_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:18.754450 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:18.878133 [info ] [Thread-3 (]: 28 of 32 PASS unique_dim_time_date_key ......................................... [[32mPASS[0m in 0.76s]
[0m16:06:18.878530 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.unique_dim_time_date_key.c815c3216d
[0m16:06:18.878781 [debug] [Thread-3 (]: Began running node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m16:06:18.879073 [info ] [Thread-3 (]: 32 of 32 START test unique_stg_movies_movie_id ................................. [RUN]
[0m16:06:18.879539 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.tmdb_analytics.unique_dim_time_date_key.c815c3216d, now test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78)
[0m16:06:18.879759 [debug] [Thread-3 (]: Began compiling node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m16:06:18.882328 [debug] [Thread-3 (]: Writing injected SQL for node "test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78"
[0m16:06:18.882762 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78 (compile): 16:06:18.879878 => 16:06:18.882642
[0m16:06:18.882961 [debug] [Thread-3 (]: Began executing node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m16:06:18.884397 [debug] [Thread-3 (]: Writing runtime sql for node "test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78"
[0m16:06:18.884951 [debug] [Thread-3 (]: Using snowflake connection "test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78"
[0m16:06:18.885159 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "tmdb_snowflake", "target_name": "dev", "node_id": "test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    movie_id as unique_field,
    count(*) as n_records

from TMDB_DW.ANALYTICS_staging.stg_movies
where movie_id is not null
group by movie_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:18.885357 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:18.960731 [info ] [Thread-1 (]: 29 of 32 PASS unique_fact_credit_credit_key .................................... [[32mPASS[0m in 0.78s]
[0m16:06:18.961143 [debug] [Thread-1 (]: Finished running node test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee
[0m16:06:19.212509 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:19.217021 [debug] [Thread-2 (]: Timing info for test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da (execute): 16:06:18.627899 => 16:06:19.216666
[0m16:06:19.217666 [debug] [Thread-2 (]: On test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da: Close
[0m16:06:19.334992 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:19.339574 [debug] [Thread-4 (]: Timing info for test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1 (execute): 16:06:18.750336 => 16:06:19.339158
[0m16:06:19.340230 [debug] [Thread-4 (]: On test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1: Close
[0m16:06:19.437464 [info ] [Thread-2 (]: 30 of 32 PASS unique_fact_movie_movie_key ...................................... [[32mPASS[0m in 0.82s]
[0m16:06:19.438913 [debug] [Thread-2 (]: Finished running node test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da
[0m16:06:19.550186 [info ] [Thread-4 (]: 31 of 32 PASS unique_stg_credits_credit_id ..................................... [[32mPASS[0m in 0.81s]
[0m16:06:19.550942 [debug] [Thread-4 (]: Finished running node test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1
[0m16:06:19.631954 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:06:19.636892 [debug] [Thread-3 (]: Timing info for test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78 (execute): 16:06:18.883078 => 16:06:19.636544
[0m16:06:19.637623 [debug] [Thread-3 (]: On test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78: Close
[0m16:06:19.856516 [info ] [Thread-3 (]: 32 of 32 PASS unique_stg_movies_movie_id ....................................... [[32mPASS[0m in 0.98s]
[0m16:06:19.858082 [debug] [Thread-3 (]: Finished running node test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78
[0m16:06:19.860863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:19.861309 [debug] [MainThread]: Connection 'test.tmdb_analytics.unique_fact_credit_credit_key.c9ed392fee' was properly closed.
[0m16:06:19.861633 [debug] [MainThread]: Connection 'test.tmdb_analytics.unique_fact_movie_movie_key.73a0a046da' was properly closed.
[0m16:06:19.861918 [debug] [MainThread]: Connection 'test.tmdb_analytics.unique_stg_movies_movie_id.51c7c15c78' was properly closed.
[0m16:06:19.862168 [debug] [MainThread]: Connection 'test.tmdb_analytics.unique_stg_credits_credit_id.af4ec3fce1' was properly closed.
[0m16:06:19.862452 [info ] [MainThread]: 
[0m16:06:19.862748 [info ] [MainThread]: Finished running 32 tests in 0 hours 0 minutes and 12.97 seconds (12.97s).
[0m16:06:19.866285 [debug] [MainThread]: Command end result
[0m16:06:19.874913 [info ] [MainThread]: 
[0m16:06:19.875192 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:19.875415 [info ] [MainThread]: 
[0m16:06:19.875639 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m16:06:19.878663 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.342563, "process_user_time": 3.19057, "process_kernel_time": 0.501201, "process_mem_max_rss": "227737600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:06:19.879010 [debug] [MainThread]: Command `dbt test` succeeded at 16:06:19.878932 after 13.34 seconds
[0m16:06:19.879249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106491940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c6dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b3bec0>]}
[0m16:06:19.879496 [debug] [MainThread]: Flushing usage events
